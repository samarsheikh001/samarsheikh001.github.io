<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head >
    <title>AWS CDK - Fullstack Polyglot with Asset Bundling</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width, initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="og:type" name="og:type" property="og:type" content="website"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="preconnect" href="https://fonts.gstatic.com"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&amp;display=swap"><link data-n-head="ssr" data-hid="shortcut-icon" rel="shortcut icon" href="/_nuxt/icons/icon_64x64.e3e9fb.png"><link data-n-head="ssr" data-hid="apple-touch-icon" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.e3e9fb.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.f9c56d04.json" data-hid="manifest"><link rel="preload" href="/_nuxt/548109a.js" as="script"><link rel="preload" href="/_nuxt/84567ea.js" as="script"><link rel="preload" href="/_nuxt/ad2e88f.js" as="script"><link rel="preload" href="/_nuxt/a9b0fbe.js" as="script"><link rel="preload" href="/_nuxt/c3ddcce.js" as="script"><style data-vue-ssr-id="54b08540:0 a57b151a:0 1239d49d:0 bc0f4dfc:0 59be0982:0 4d321698:0 3c003464:0 6cfba90a:0">/*! tailwindcss v2.2.16 | MIT License | https://tailwindcss.com*/

/*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */

/*
Document
========
*/

/**
Use a better box model (opinionated).
*/

*,
::before,
::after {
  box-sizing: border-box;
}

/**
Use a more readable tab size (opinionated).
*/

html {
  -moz-tab-size: 4;
  -o-tab-size: 4;
     tab-size: 4;
}

/**
1. Correct the line height in all browsers.
2. Prevent adjustments of font size after orientation changes in iOS.
*/

html {
  line-height: 1.15; /* 1 */
  -webkit-text-size-adjust: 100%; /* 2 */
}

/*
Sections
========
*/

/**
Remove the margin in all browsers.
*/

body {
  margin: 0;
}

/**
Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)
*/

body {
  font-family:
		system-ui,
		-apple-system, /* Firefox supports this but not yet `system-ui` */
		'Segoe UI',
		Roboto,
		Helvetica,
		Arial,
		sans-serif,
		'Apple Color Emoji',
		'Segoe UI Emoji';
}

/*
Grouping content
================
*/

/**
1. Add the correct height in Firefox.
2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)
*/

hr {
  height: 0; /* 1 */
  color: inherit; /* 2 */
}

/*
Text-level semantics
====================
*/

/**
Add the correct text decoration in Chrome, Edge, and Safari.
*/

abbr[title] {
  -webkit-text-decoration: underline dotted;
          text-decoration: underline dotted;
}

/**
Add the correct font weight in Edge and Safari.
*/

b,
strong {
  font-weight: bolder;
}

/**
1. Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)
2. Correct the odd 'em' font sizing in all browsers.
*/

code,
kbd,
samp,
pre {
  font-family:
		ui-monospace,
		SFMono-Regular,
		Consolas,
		'Liberation Mono',
		Menlo,
		monospace; /* 1 */
  font-size: 1em; /* 2 */
}

/**
Add the correct font size in all browsers.
*/

small {
  font-size: 80%;
}

/**
Prevent 'sub' and 'sup' elements from affecting the line height in all browsers.
*/

sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

/*
Tabular data
============
*/

/**
1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)
2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)
*/

table {
  text-indent: 0; /* 1 */
  border-color: inherit; /* 2 */
}

/*
Forms
=====
*/

/**
1. Change the font styles in all browsers.
2. Remove the margin in Firefox and Safari.
*/

button,
input,
optgroup,
select,
textarea {
  font-family: inherit; /* 1 */
  font-size: 100%; /* 1 */
  line-height: 1.15; /* 1 */
  margin: 0; /* 2 */
}

/**
Remove the inheritance of text transform in Edge and Firefox.
1. Remove the inheritance of text transform in Firefox.
*/

button,
select { /* 1 */
  text-transform: none;
}

/**
Correct the inability to style clickable types in iOS and Safari.
*/

button,
[type='button'],
[type='submit'] {
  -webkit-appearance: button;
}

/**
Remove the inner border and padding in Firefox.
*/

/**
Restore the focus styles unset by the previous rule.
*/

/**
Remove the additional ':invalid' styles in Firefox.
See: https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737
*/

/**
Remove the padding so developers are not caught out when they zero out 'fieldset' elements in all browsers.
*/

legend {
  padding: 0;
}

/**
Add the correct vertical alignment in Chrome and Firefox.
*/

progress {
  vertical-align: baseline;
}

/**
Correct the cursor style of increment and decrement buttons in Safari.
*/

/**
1. Correct the odd appearance in Chrome and Safari.
2. Correct the outline style in Safari.
*/

[type='search'] {
  -webkit-appearance: textfield; /* 1 */
  outline-offset: -2px; /* 2 */
}

/**
Remove the inner padding in Chrome and Safari on macOS.
*/

/**
1. Correct the inability to style clickable types in iOS and Safari.
2. Change font properties to 'inherit' in Safari.
*/

/*
Interactive
===========
*/

/*
Add the correct display in Chrome and Safari.
*/

summary {
  display: list-item;
}

/**
 * Manually forked from SUIT CSS Base: https://github.com/suitcss/base
 * A thin layer on top of normalize.css that provides a starting point more
 * suitable for web applications.
 */

/**
 * Removes the default spacing and border for appropriate elements.
 */

blockquote,
dl,
dd,
h1,
h2,
h3,
h4,
h5,
h6,
hr,
figure,
p,
pre {
  margin: 0;
}

button {
  background-color: transparent;
  background-image: none;
}

fieldset {
  margin: 0;
  padding: 0;
}

ol,
ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

/**
 * Tailwind custom reset styles
 */

/**
 * 1. Use the user's configured `sans` font-family (with Tailwind's default
 *    sans-serif font stack as a fallback) as a sane default.
 * 2. Use Tailwind's default "normal" line-height so the user isn't forced
 *    to override it to ensure consistency even when using the default theme.
 */

html {
  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; /* 1 */
  line-height: 1.5; /* 2 */
}

/**
 * Inherit font-family and line-height from `html` so users can set them as
 * a class directly on the `html` element.
 */

body {
  font-family: inherit;
  line-height: inherit;
}

/**
 * 1. Prevent padding and border from affecting element width.
 *
 *    We used to set this in the html element and inherit from
 *    the parent element for everything else. This caused issues
 *    in shadow-dom-enhanced elements like <details> where the content
 *    is wrapped by a div with box-sizing set to `content-box`.
 *
 *    https://github.com/mozdevs/cssremedy/issues/4
 *
 *
 * 2. Allow adding a border to an element by just adding a border-width.
 *
 *    By default, the way the browser specifies that an element should have no
 *    border is by setting it's border-style to `none` in the user-agent
 *    stylesheet.
 *
 *    In order to easily add borders to elements by just setting the `border-width`
 *    property, we change the default border-style for all elements to `solid`, and
 *    use border-width to hide them instead. This way our `border` utilities only
 *    need to set the `border-width` property instead of the entire `border`
 *    shorthand, making our border utilities much more straightforward to compose.
 *
 *    https://github.com/tailwindcss/tailwindcss/pull/116
 */

*,
::before,
::after {
  box-sizing: border-box; /* 1 */
  border-width: 0; /* 2 */
  border-style: solid; /* 2 */
  border-color: currentColor; /* 2 */
}

/*
 * Ensure horizontal rules are visible by default
 */

hr {
  border-top-width: 1px;
}

/**
 * Undo the `border-style: none` reset that Normalize applies to images so that
 * our `border-{width}` utilities have the expected effect.
 *
 * The Normalize reset is unnecessary for us since we default the border-width
 * to 0 on all elements.
 *
 * https://github.com/tailwindcss/tailwindcss/issues/362
 */

img {
  border-style: solid;
}

textarea {
  resize: vertical;
}

input::-moz-placeholder, textarea::-moz-placeholder {
  opacity: 1;
  color: #9ca3af;
}

input:-ms-input-placeholder, textarea:-ms-input-placeholder {
  opacity: 1;
  color: #9ca3af;
}

input::placeholder,
textarea::placeholder {
  opacity: 1;
  color: #9ca3af;
}

button {
  cursor: pointer;
}

/**
 * Override legacy focus reset from Normalize with modern Firefox focus styles.
 *
 * This is actually an improvement over the new defaults in Firefox in our testing,
 * as it triggers the better focus styles even for links, which still use a dotted
 * outline in Firefox by default.
 */

table {
  border-collapse: collapse;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-size: inherit;
  font-weight: inherit;
}

/**
 * Reset links to optimize for opt-in styling instead of
 * opt-out.
 */

a {
  color: inherit;
  text-decoration: inherit;
}

/**
 * Reset form element properties that are easy to forget to
 * style explicitly so you don't inadvertently introduce
 * styles that deviate from your design system. These styles
 * supplement a partial reset that is already applied by
 * normalize.css.
 */

button,
input,
optgroup,
select,
textarea {
  padding: 0;
  line-height: inherit;
  color: inherit;
}

/**
 * Use the configured 'mono' font family for elements that
 * are expected to be rendered with a monospace font, falling
 * back to the system monospace stack if there is no configured
 * 'mono' font family.
 */

pre,
code,
kbd,
samp {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

/**
 * 1. Make replaced elements `display: block` by default as that's
 *    the behavior you want almost all of the time. Inspired by
 *    CSS Remedy, with `svg` added as well.
 *
 *    https://github.com/mozdevs/cssremedy/issues/14
 * 
 * 2. Add `vertical-align: middle` to align replaced elements more
 *    sensibly by default when overriding `display` by adding a
 *    utility like `inline`.
 *
 *    This can trigger a poorly considered linting error in some
 *    tools but is included by design.
 * 
 *    https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210
 */

img,
svg,
video,
canvas,
audio,
iframe,
embed,
object {
  display: block; /* 1 */
  vertical-align: middle; /* 2 */
}

/**
 * Constrain images and videos to the parent width and preserve
 * their intrinsic aspect ratio.
 *
 * https://github.com/mozdevs/cssremedy/issues/14
 */

img,
video {
  max-width: 100%;
  height: auto;
}

/**
 * Ensure the default browser behavior of the `hidden` attribute.
 */

[hidden] {
  display: none;
}

*, ::before, ::after{
  --tw-border-opacity:1;
  border-color:rgba(229, 231, 235, var(--tw-border-opacity));
}

.container{
  width:100%;
}

@media (min-width: 640px){
  .container{
    max-width:640px;
  }
}

@media (min-width: 768px){
  .container{
    max-width:768px;
  }
}

@media (min-width: 1024px){
  .container{
    max-width:1024px;
  }
}

@media (min-width: 1280px){
  .container{
    max-width:1280px;
  }
}

@media (min-width: 1536px){
  .container{
    max-width:1536px;
  }
}

.static{
  position:static;
}

.absolute{
  position:absolute;
}

.relative{
  position:relative;
}

.top-1\/2{
  top:50%;
}

.left-1\/2{
  left:50%;
}

.m-4{
  margin:1rem;
}

.mx-auto{
  margin-left:auto;
  margin-right:auto;
}

.my-2{
  margin-top:0.5rem;
  margin-bottom:0.5rem;
}

.my-4{
  margin-top:1rem;
  margin-bottom:1rem;
}

.mt-4{
  margin-top:1rem;
}

.mt-6{
  margin-top:1.5rem;
}

.mr-1{
  margin-right:0.25rem;
}

.mr-2{
  margin-right:0.5rem;
}

.mr-1\.5{
  margin-right:0.375rem;
}

.-mr-2{
  margin-right:-0.5rem;
}

.mb-3{
  margin-bottom:0.75rem;
}

.mb-4{
  margin-bottom:1rem;
}

.mb-6{
  margin-bottom:1.5rem;
}

.ml-2{
  margin-left:0.5rem;
}

.ml-4{
  margin-left:1rem;
}

.ml-10{
  margin-left:2.5rem;
}

.-ml-0{
  margin-left:0px;
}

.-ml-0\.5{
  margin-left:-0.125rem;
}

.block{
  display:block;
}

.flex{
  display:flex;
}

.inline-flex{
  display:inline-flex;
}

.table{
  display:table;
}

.hidden{
  display:none;
}

.h-2{
  height:0.5rem;
}

.h-4{
  height:1rem;
}

.h-6{
  height:1.5rem;
}

.h-8{
  height:2rem;
}

.h-12{
  height:3rem;
}

.h-16{
  height:4rem;
}

.w-2{
  width:0.5rem;
}

.w-6{
  width:1.5rem;
}

.w-8{
  width:2rem;
}

.w-12{
  width:3rem;
}

.w-64{
  width:16rem;
}

.w-1\/2{
  width:50%;
}

.w-3\/4{
  width:75%;
}

.w-full{
  width:100%;
}

.max-w-xs{
  max-width:20rem;
}

.max-w-sm{
  max-width:24rem;
}

.max-w-7xl{
  max-width:80rem;
}

.max-w-screen-md{
  max-width:768px;
}

.max-w-screen-xl{
  max-width:1280px;
}

.flex-1{
  flex:1 1 0%;
}

.flex-shrink-0{
  flex-shrink:0;
}

.transform{
  --tw-translate-x:0;
  --tw-translate-y:0;
  --tw-rotate:0;
  --tw-skew-x:0;
  --tw-skew-y:0;
  --tw-scale-x:1;
  --tw-scale-y:1;
  transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.-translate-x-1\/2{
  --tw-translate-x:-50%;
}

.-translate-y-1\/2{
  --tw-translate-y:-50%;
}

@-webkit-keyframes spin{
  to{
    transform:rotate(360deg);
  }
}

@keyframes spin{
  to{
    transform:rotate(360deg);
  }
}

@-webkit-keyframes ping{
  75%, 100%{
    transform:scale(2);
    opacity:0;
  }
}

@keyframes ping{
  75%, 100%{
    transform:scale(2);
    opacity:0;
  }
}

@-webkit-keyframes pulse{
  50%{
    opacity:.5;
  }
}

@keyframes pulse{
  50%{
    opacity:.5;
  }
}

@-webkit-keyframes bounce{
  0%, 100%{
    transform:translateY(-25%);
    -webkit-animation-timing-function:cubic-bezier(0.8,0,1,1);
            animation-timing-function:cubic-bezier(0.8,0,1,1);
  }

  50%{
    transform:none;
    -webkit-animation-timing-function:cubic-bezier(0,0,0.2,1);
            animation-timing-function:cubic-bezier(0,0,0.2,1);
  }
}

@keyframes bounce{
  0%, 100%{
    transform:translateY(-25%);
    -webkit-animation-timing-function:cubic-bezier(0.8,0,1,1);
            animation-timing-function:cubic-bezier(0.8,0,1,1);
  }

  50%{
    transform:none;
    -webkit-animation-timing-function:cubic-bezier(0,0,0.2,1);
            animation-timing-function:cubic-bezier(0,0,0.2,1);
  }
}

.appearance-none{
  -webkit-appearance:none;
     -moz-appearance:none;
          appearance:none;
}

.flex-col{
  flex-direction:column;
}

.flex-wrap{
  flex-wrap:wrap;
}

.items-center{
  align-items:center;
}

.items-baseline{
  align-items:baseline;
}

.justify-start{
  justify-content:flex-start;
}

.justify-center{
  justify-content:center;
}

.justify-between{
  justify-content:space-between;
}

.space-x-4 > :not([hidden]) ~ :not([hidden]){
  --tw-space-x-reverse:0;
  margin-right:calc(1rem * var(--tw-space-x-reverse));
  margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)));
}

.space-y-1 > :not([hidden]) ~ :not([hidden]){
  --tw-space-y-reverse:0;
  margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));
  margin-bottom:calc(0.25rem * var(--tw-space-y-reverse));
}

.space-y-3 > :not([hidden]) ~ :not([hidden]){
  --tw-space-y-reverse:0;
  margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));
  margin-bottom:calc(0.75rem * var(--tw-space-y-reverse));
}

.rounded{
  border-radius:0.25rem;
}

.rounded-md{
  border-radius:0.375rem;
}

.rounded-lg{
  border-radius:0.5rem;
}

.rounded-xl{
  border-radius:0.75rem;
}

.rounded-2xl{
  border-radius:1rem;
}

.rounded-full{
  border-radius:9999px;
}

.rounded-l-full{
  border-top-left-radius:9999px;
  border-bottom-left-radius:9999px;
}

.border{
  border-width:1px;
}

.border-transparent{
  border-color:transparent;
}

.border-gray-300{
  --tw-border-opacity:1;
  border-color:rgba(209, 213, 219, var(--tw-border-opacity));
}

.hover\:border-white:hover{
  --tw-border-opacity:1;
  border-color:rgba(255, 255, 255, var(--tw-border-opacity));
}

.focus\:border-transparent:focus{
  border-color:transparent;
}

.bg-black{
  --tw-bg-opacity:1;
  background-color:rgba(0, 0, 0, var(--tw-bg-opacity));
}

.bg-white{
  --tw-bg-opacity:1;
  background-color:rgba(255, 255, 255, var(--tw-bg-opacity));
}

.bg-gray-100{
  --tw-bg-opacity:1;
  background-color:rgba(243, 244, 246, var(--tw-bg-opacity));
}

.bg-purple-200{
  --tw-bg-opacity:1;
  background-color:rgba(221, 214, 254, var(--tw-bg-opacity));
}

.hover\:bg-white:hover{
  --tw-bg-opacity:1;
  background-color:rgba(255, 255, 255, var(--tw-bg-opacity));
}

.hover\:bg-gray-500:hover{
  --tw-bg-opacity:1;
  background-color:rgba(107, 114, 128, var(--tw-bg-opacity));
}

.hover\:bg-gray-600:hover{
  --tw-bg-opacity:1;
  background-color:rgba(75, 85, 99, var(--tw-bg-opacity));
}

.hover\:bg-gray-800:hover{
  --tw-bg-opacity:1;
  background-color:rgba(31, 41, 55, var(--tw-bg-opacity));
}

.p-2{
  padding:0.5rem;
}

.p-4{
  padding:1rem;
}

.p-8{
  padding:2rem;
}

.px-2{
  padding-left:0.5rem;
  padding-right:0.5rem;
}

.px-3{
  padding-left:0.75rem;
  padding-right:0.75rem;
}

.px-4{
  padding-left:1rem;
  padding-right:1rem;
}

.px-6{
  padding-left:1.5rem;
  padding-right:1.5rem;
}

.px-8{
  padding-left:2rem;
  padding-right:2rem;
}

.px-2\.5{
  padding-left:0.625rem;
  padding-right:0.625rem;
}

.py-0{
  padding-top:0px;
  padding-bottom:0px;
}

.py-2{
  padding-top:0.5rem;
  padding-bottom:0.5rem;
}

.py-3{
  padding-top:0.75rem;
  padding-bottom:0.75rem;
}

.py-4{
  padding-top:1rem;
  padding-bottom:1rem;
}

.py-8{
  padding-top:2rem;
  padding-bottom:2rem;
}

.py-0\.5{
  padding-top:0.125rem;
  padding-bottom:0.125rem;
}

.pt-2{
  padding-top:0.5rem;
}

.pt-8{
  padding-top:2rem;
}

.pt-10{
  padding-top:2.5rem;
}

.pb-2{
  padding-bottom:0.5rem;
}

.pb-3{
  padding-bottom:0.75rem;
}

.pb-8{
  padding-bottom:2rem;
}

.text-left{
  text-align:left;
}

.text-center{
  text-align:center;
}

.text-right{
  text-align:right;
}

.text-xs{
  font-size:0.75rem;
  line-height:1rem;
}

.text-sm{
  font-size:0.875rem;
  line-height:1.25rem;
}

.text-base{
  font-size:1rem;
  line-height:1.5rem;
}

.text-lg{
  font-size:1.125rem;
  line-height:1.75rem;
}

.text-xl{
  font-size:1.25rem;
  line-height:1.75rem;
}

.text-2xl{
  font-size:1.5rem;
  line-height:2rem;
}

.text-3xl{
  font-size:1.875rem;
  line-height:2.25rem;
}

.text-4xl{
  font-size:2.25rem;
  line-height:2.5rem;
}

.text-5xl{
  font-size:3rem;
  line-height:1;
}

.font-thin{
  font-weight:100;
}

.font-light{
  font-weight:300;
}

.font-medium{
  font-weight:500;
}

.font-semibold{
  font-weight:600;
}

.font-bold{
  font-weight:700;
}

.capitalize{
  text-transform:capitalize;
}

.leading-tight{
  line-height:1.25;
}

.text-black{
  --tw-text-opacity:1;
  color:rgba(0, 0, 0, var(--tw-text-opacity));
}

.text-white{
  --tw-text-opacity:1;
  color:rgba(255, 255, 255, var(--tw-text-opacity));
}

.text-gray-300{
  --tw-text-opacity:1;
  color:rgba(209, 213, 219, var(--tw-text-opacity));
}

.text-gray-400{
  --tw-text-opacity:1;
  color:rgba(156, 163, 175, var(--tw-text-opacity));
}

.text-gray-500{
  --tw-text-opacity:1;
  color:rgba(107, 114, 128, var(--tw-text-opacity));
}

.text-gray-700{
  --tw-text-opacity:1;
  color:rgba(55, 65, 81, var(--tw-text-opacity));
}

.text-gray-800{
  --tw-text-opacity:1;
  color:rgba(31, 41, 55, var(--tw-text-opacity));
}

.text-green-500{
  --tw-text-opacity:1;
  color:rgba(16, 185, 129, var(--tw-text-opacity));
}

.text-purple-500{
  --tw-text-opacity:1;
  color:rgba(139, 92, 246, var(--tw-text-opacity));
}

.hover\:text-white:hover{
  --tw-text-opacity:1;
  color:rgba(255, 255, 255, var(--tw-text-opacity));
}

.hover\:text-gray-300:hover{
  --tw-text-opacity:1;
  color:rgba(209, 213, 219, var(--tw-text-opacity));
}

.hover\:text-gray-800:hover{
  --tw-text-opacity:1;
  color:rgba(31, 41, 55, var(--tw-text-opacity));
}

.placeholder-gray-400::-moz-placeholder{
  --tw-placeholder-opacity:1;
  color:rgba(156, 163, 175, var(--tw-placeholder-opacity));
}

.placeholder-gray-400:-ms-input-placeholder{
  --tw-placeholder-opacity:1;
  color:rgba(156, 163, 175, var(--tw-placeholder-opacity));
}

.placeholder-gray-400::placeholder{
  --tw-placeholder-opacity:1;
  color:rgba(156, 163, 175, var(--tw-placeholder-opacity));
}

.opacity-50{
  opacity:0.5;
}

*, ::before, ::after{
  --tw-shadow:0 0 #0000;
}

.shadow-sm{
  --tw-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);
  box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow{
  --tw-shadow:0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
  box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-md{
  --tw-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-lg{
  --tw-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-xl{
  --tw-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.focus\:outline-none:focus{
  outline:2px solid transparent;
  outline-offset:2px;
}

*, ::before, ::after{
  --tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);
  --tw-ring-offset-width:0px;
  --tw-ring-offset-color:#fff;
  --tw-ring-color:rgba(59, 130, 246, 0.5);
  --tw-ring-offset-shadow:0 0 #0000;
  --tw-ring-shadow:0 0 #0000;
}

.focus\:ring-2:focus{
  --tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

.focus\:ring-white:focus{
  --tw-ring-opacity:1;
  --tw-ring-color:rgba(255, 255, 255, var(--tw-ring-opacity));
}

.focus\:ring-gray-400:focus{
  --tw-ring-opacity:1;
  --tw-ring-color:rgba(156, 163, 175, var(--tw-ring-opacity));
}

.focus\:ring-offset-2:focus{
  --tw-ring-offset-width:2px;
}

.focus\:ring-offset-white:focus{
  --tw-ring-offset-color:#fff;
}

.filter{
  --tw-blur:var(--tw-empty,/*!*/ /*!*/);
  --tw-brightness:var(--tw-empty,/*!*/ /*!*/);
  --tw-contrast:var(--tw-empty,/*!*/ /*!*/);
  --tw-grayscale:var(--tw-empty,/*!*/ /*!*/);
  --tw-hue-rotate:var(--tw-empty,/*!*/ /*!*/);
  --tw-invert:var(--tw-empty,/*!*/ /*!*/);
  --tw-saturate:var(--tw-empty,/*!*/ /*!*/);
  --tw-sepia:var(--tw-empty,/*!*/ /*!*/);
  --tw-drop-shadow:var(--tw-empty,/*!*/ /*!*/);
  filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
}

.transition-colors{
  transition-property:background-color, border-color, color, fill, stroke;
  transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration:150ms;
}

.duration-200{
  transition-duration:200ms;
}

@media (min-width: 640px){
  .sm\:px-3{
    padding-left:0.75rem;
    padding-right:0.75rem;
  }

  .sm\:pt-12{
    padding-top:3rem;
  }
}

@media (min-width: 768px){
  .md\:ml-6{
    margin-left:1.5rem;
  }

  .md\:block{
    display:block;
  }

  .md\:flex{
    display:flex;
  }

  .md\:hidden{
    display:none;
  }

  .md\:w-full{
    width:100%;
  }

  .md\:flex-row{
    flex-direction:row;
  }

  .md\:justify-between{
    justify-content:space-between;
  }

  .md\:space-x-3 > :not([hidden]) ~ :not([hidden]){
    --tw-space-x-reverse:0;
    margin-right:calc(0.75rem * var(--tw-space-x-reverse));
    margin-left:calc(0.75rem * calc(1 - var(--tw-space-x-reverse)));
  }

  .md\:space-y-0 > :not([hidden]) ~ :not([hidden]){
    --tw-space-y-reverse:0;
    margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));
    margin-bottom:calc(0px * var(--tw-space-y-reverse));
  }

  .md\:p-16{
    padding:4rem;
  }

  .md\:text-center{
    text-align:center;
  }

  .md\:text-3xl{
    font-size:1.875rem;
    line-height:2.25rem;
  }
}

@media (min-width: 1024px){
}

@media (min-width: 1280px){
}

@media (min-width: 1536px){
}
/*purgecss start ignore*/
.nuxt-progress{
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:2px;
  width:0;
  opacity:1;
  transition:width .1s,opacity .4s;
  background-color:#000;
  z-index:999999
}
.nuxt-progress.nuxt-progress-notransition{
  transition:none
}
.nuxt-progress-failed{
  background-color:red
}

/*purgecss end ignore*/
/*purgecss start ignore*/
:root{
  --gray:#666
}
html{
  font-family:"Oxygen"
}
body{
  background:#0f0f0f;
  font-family:"Space Mono";
  color:#fff
}

/*purgecss end ignore*/
/*purgecss start ignore*/

/*purgecss end ignore*/
/*purgecss start ignore*/
.page-wrapper[data-v-3bf13c85]{
  margin:auto;
  padding:1rem
}
.article-content-wrapper[data-v-3bf13c85]{
  display:flex;
  flex-direction:column;
  align-items:center;
  margin:auto auto 2rem
}
.article-content-wrapper .article-block[data-v-3bf13c85]{
  width:100%;
  max-width:880px
}
.article-content-wrapper .aside-username-wrapper[data-v-3bf13c85]{
  max-width:880px;
  width:100%;
  position:relative
}
.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-3bf13c85]{
  position:-webkit-sticky;
  position:sticky;
  top:1rem
}

/*purgecss end ignore*/
/*purgecss start ignore*/
article[data-v-25febe66]{
  padding:.5rem;
  border-radius:1rem
}
header[data-v-25febe66],header h1[data-v-25febe66]{
  margin-bottom:1rem
}
header .tags[data-v-25febe66]{
  display:flex;
  flex-wrap:wrap;
  margin-bottom:1.5rem
}
header .tags .tag[data-v-25febe66]{
  line-height:1;
  padding:.5rem;
  margin:0 .5rem .5rem 0;
  border-radius:.25rem
}
header .tags .tag[data-v-25febe66]:active{
  background:transparent
}
header .image-wrapper[data-v-25febe66]{
  position:relative;
  padding-bottom:56.25%;
  margin-bottom:1.5rem;
  border-radius:.5rem;
  overflow:hidden
}
header .image-wrapper img[data-v-25febe66]{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  -o-object-fit:cover;
     object-fit:cover
}
header .meta[data-v-25febe66]{
  line-height:1;
  text-transform:uppercase;
  display:flex;
  align-items:center;
  justify-content:space-between
}
header .meta .scl[data-v-25febe66]{
  display:flex
}
header .meta .scl span[data-v-25febe66]{
  display:flex;
  align-items:center;
  margin-right:1rem
}
header .meta .scl span svg[data-v-25febe66]{
  margin-right:.25rem
}
header .meta .scl .comments[data-v-25febe66]{
  cursor:pointer
}
[data-v-25febe66] .content .ltag__user{
  display:none
}
[data-v-25febe66] .content iframe{
  max-width:100%
}
[data-v-25febe66] .content h1,[data-v-25febe66] .content h2,[data-v-25febe66] .content h3,[data-v-25febe66] .content h4{
  margin-top:2rem;
  margin-bottom:1rem
}
[data-v-25febe66] .content p{
  margin-bottom:1rem;
  line-height:1.4
}
[data-v-25febe66] .content p code{
  background-color:#d2f3e1;
  border-radius:.25rem;
  padding:.25rem
}
[data-v-25febe66] .content img{
  width:100%;
  border-radius:.5rem
}
[data-v-25febe66] .content .highlight{
  margin-bottom:1rem;
  border-radius:.5rem
}
[data-v-25febe66] .content ul{
  list-style:numeral;
  margin-bottom:1rem
}
[data-v-25febe66] .content ul li p{
  margin-bottom:0
}
[data-v-25febe66] .content ol{
  margin-bottom:1rem
}

/*purgecss end ignore*/
/*purgecss start ignore*/
aside[data-v-29ea5fa2]{
  padding:1rem;
  border-radius:1rem
}
aside .username-heading[data-v-29ea5fa2]{
  display:flex;
  margin-bottom:1rem
}
aside .username-heading img[data-v-29ea5fa2]{
  width:3rem;
  height:3rem;
  border-radius:50%;
  margin-right:1rem
}
aside .username-heading .text[data-v-29ea5fa2]{
  display:flex;
  flex-direction:column;
  justify-content:center
}
aside .username-heading .text a[data-v-29ea5fa2]{
  line-height:1
}
aside .username-heading .text a[data-v-29ea5fa2]:first-child{
  margin-bottom:.25rem
}
aside .username-heading.loading[data-v-29ea5fa2]{
  display:block
}
aside .f-button[data-v-29ea5fa2]{
  display:block;
  width:100%;
  padding:.5rem;
  border-radius:.5rem;
  text-transform:uppercase;
  text-align:center;
  margin-bottom:1rem
}
aside .f-button[data-v-29ea5fa2]:active{
  background:transparent
}
aside .info>div[data-v-29ea5fa2]{
  margin-bottom:.5rem
}
aside .info .title[data-v-29ea5fa2]{
  text-transform:uppercase;
  margin-bottom:.1rem
}
aside .info .content[data-v-29ea5fa2]{
  line-height:1.4
}

/*purgecss end ignore*/
/*purgecss start ignore*/
.add-comment[data-v-54aa1ab4]{
  display:block;
  width:100%;
  padding:.5rem;
  border-radius:.5rem;
  text-transform:uppercase;
  text-align:center;
  margin-bottom:1rem
}
.add-comment[data-v-54aa1ab4]:active{
  background:transparent
}

/*purgecss end ignore*/</style><link rel="preload" href="/_nuxt/static/1634322943/articles/elthrasher/641503/state.js" as="script"><link rel="preload" href="/_nuxt/static/1634322943/articles/elthrasher/641503/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1634322943/manifest.js" as="script">
  </head>
  <body >
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div><nav class="py-4"><div class="max-w-7xl mx-auto px-8"><div class="flex items-center justify-between h-16"><div class="flex items-center"><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 50 62.5" enable-background="new 0 0 50 50" xml:space="preserve"><path fill="#FFFFFF" d="M25,1C11.745,1,1,11.745,1,25s10.745,24,24,24s24-10.745,24-24S38.255,1,25,1z M17.887,38.646  c0.097,0.099,0.097,0.257-0.001,0.354c-0.049,0.049-0.112,0.073-0.176,0.073s-0.128-0.024-0.177-0.073L3.767,25.177  c-0.028-0.028-0.031-0.067-0.042-0.103c-0.008-0.025-0.03-0.047-0.03-0.073s0.022-0.048,0.03-0.073  c0.012-0.036,0.014-0.075,0.042-0.103l13.766-13.823c0.098-0.099,0.256-0.098,0.354-0.001c0.098,0.098,0.098,0.256,0.001,0.354  L4.297,25.001L17.887,38.646z M46.232,25.178c0,0-0.001,0-0.002,0l-13.765,13.82c-0.049,0.049-0.112,0.073-0.177,0.073  c-0.063,0-0.128-0.024-0.177-0.073c-0.098-0.097-0.098-0.255,0-0.354l13.591-13.645L32.112,11.354c-0.098-0.098-0.098-0.256,0-0.354  c0.098-0.097,0.256-0.097,0.354,0.001L46.23,24.823c0.001,0,0.002,0,0.002,0c0.049,0.049,0.073,0.113,0.073,0.177  S46.281,25.129,46.232,25.178z"></path></svg> <h1 class="text-white text-2xl px-2 pb-2">CodeLabs.</h1></div> <div class="hidden md:block"><div class="ml-10 flex items-baseline space-x-4"><a href="/" class="
                  text-gray-300
                  hover:border-white
                  border border-transparent
                  px-3
                  py-2
                  rounded-md
                  text-sm
                  font-medium
                 nuxt-link-active bg-white text-gray-800">Home</a><a href="/articles/elthrasher/Articles" class="
                  text-gray-300
                  hover:border-white
                  border border-transparent
                  px-3
                  py-2
                  rounded-md
                  text-sm
                  font-medium
                ">Articles</a><a href="/articles/elthrasher/Lessons" class="
                  text-gray-300
                  hover:border-white
                  border border-transparent
                  px-3
                  py-2
                  rounded-md
                  text-sm
                  font-medium
                ">Lessons</a><a href="/articles/elthrasher/Courses" class="
                  text-gray-300
                  hover:border-white
                  border border-transparent
                  px-3
                  py-2
                  rounded-md
                  text-sm
                  font-medium
                ">Courses</a><a href="/articles/elthrasher/Pricing" class="
                  text-gray-300
                  hover:border-white
                  border border-transparent
                  px-3
                  py-2
                  rounded-md
                  text-sm
                  font-medium
                ">Pricing</a><a href="/articles/elthrasher/Sponsor" class="
                  text-gray-300
                  hover:border-white
                  border border-transparent
                  px-3
                  py-2
                  rounded-md
                  text-sm
                  font-medium
                ">Sponsor</a></div></div></div> <div class="block"><div class="ml-4 flex items-center md:ml-6"></div></div> <div class="-mr-2 flex md:hidden"><button class="
              text-white
              hover:bg-white hover:text-gray-300
              inline-flex
              items-center
              justify-center
              p-2
              rounded-md
              focus:outline-none
            "><svg width="20" height="20" fill="currentColor" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8"><path d="M1664 1344v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45z"></path></svg></button></div></div></div> <div class="md:hidden hidden"><div class="px-2 pt-2 pb-3 space-y-1 sm:px-3"><a href="/" class="
            text-gray-300
            border border-transparent
            hover:border-white
            block
            px-3
            py-2
            rounded-md
            text-base
            font-medium
           nuxt-link-active text-gray-800 bg-white">Home</a><a href="/articles/elthrasher/Articles" class="
            text-gray-300
            border border-transparent
            hover:border-white
            block
            px-3
            py-2
            rounded-md
            text-base
            font-medium
          ">Articles</a><a href="/articles/elthrasher/Lessons" class="
            text-gray-300
            border border-transparent
            hover:border-white
            block
            px-3
            py-2
            rounded-md
            text-base
            font-medium
          ">Lessons</a><a href="/articles/elthrasher/Courses" class="
            text-gray-300
            border border-transparent
            hover:border-white
            block
            px-3
            py-2
            rounded-md
            text-base
            font-medium
          ">Courses</a><a href="/articles/elthrasher/Pricing" class="
            text-gray-300
            border border-transparent
            hover:border-white
            block
            px-3
            py-2
            rounded-md
            text-base
            font-medium
          ">Pricing</a><a href="/articles/elthrasher/Sponsor" class="
            text-gray-300
            border border-transparent
            hover:border-white
            block
            px-3
            py-2
            rounded-md
            text-base
            font-medium
          ">Sponsor</a></div></div></nav></div> <div class="page-wrapper" data-v-3bf13c85><div class="article-content-wrapper" data-v-3bf13c85><article data-fetch-key="data-v-25febe66:0" class="article-block" data-v-25febe66 data-v-3bf13c85><header data-v-25febe66><h1 data-v-25febe66>AWS CDK - Fullstack Polyglot with Asset Bundling</h1> <div class="tags" data-v-25febe66><a href="/articles/t/aws" class="tag" data-v-25febe66>
          #aws
        </a><a href="/articles/t/cdk" class="tag" data-v-25febe66>
          #cdk
        </a><a href="/articles/t/go" class="tag" data-v-25febe66>
          #go
        </a><a href="/articles/t/typescript" class="tag" data-v-25febe66>
          #typescript
        </a></div> <div class="image-wrapper" data-v-25febe66><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--B-dJu4O2--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/2qdz5j7zorq3nv9sua7n.jpg" alt="AWS CDK - Fullstack Polyglot with Asset Bundling" data-v-25febe66></div> <div class="meta" data-v-25febe66><div class="scl" data-v-25febe66><span data-v-25febe66><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-25febe66 data-v-25febe66><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-25febe66 data-v-25febe66></path></svg>
            22
          </span> <span class="comments" data-v-25febe66><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-25febe66 data-v-25febe66><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-25febe66 data-v-25febe66></path></svg>
            1
          </span></div> <time data-v-25febe66>Mar 24</time></div></header> <div class="content" data-v-25febe66><p>This is my third article that deals with <a href="https://docs.aws.amazon.com/cdk/latest/guide/assets.html">asset bundling</a> in <a href="https://aws.amazon.com/cdk/">AWS CDK</a>. For more context, you may also be interested in:</p>

<ul>
<li><a href="https://dev.to/elthrasher/aws-cdk-aws-lambda-nodejs-module-9ic">Lambda NodeJS</a></li>
<li><a href="https://dev.to/aws-builders/aws-cdk-one-step-s3-websites-with-esbuild-2e3h">S3 Websites</a></li>
</ul>

<p>Asset management is one of the better features of CDK. We provide a path on the local filesystem and CDK will automatically stage the files in S3 and produce valid CloudFormation to use the files in Lambda, an S3 website, or any other use I may have for assets. The ability to bundle application code with infrastructure and push them together is a superpower and beats the heck out of anything that requires an s3 sync as an extra step.</p>

<p>Even better is when we let CDK handle the bundling internally. Not only does this make for easy one-step builds, but we can also set rules for managing change. We can tell CDK how to diff our output, thereby ensuring updates are only made when necessary. This will save enormous amounts of time on larger stacks.</p>

<p>I've covered use cases for TypeScript applications in Lambda and S3 websites in the articles linked above. In this article I'll explore how to add a function written in Go to a TypeScript CDK stack and gain all the same benefits we enjoy using a high-level construct like <a href="https://docs.aws.amazon.com/cdk/api/latest/docs/aws-lambda-nodejs-readme.html">aws-lambda-nodejs</a>.</p>

<h2>
  <a name="table-of-contents" href="#table-of-contents">
  </a>
  Table of Contents
</h2>

<ul>
<li><a href="#whygo">Why Go?</a></li>
<li><a href="#asset-hash">Asset Hash</a></li>
<li><a href="#local-bundling">Local Bundling</a></li>
<li><a href="#docker-bundling">Docker Bundling</a></li>
<li><a href="#byo-dockerfile">BYO Dockerfile</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>

<h2>
  <a name="why-go" href="#why-go">
  </a>
  Why Go?<a name="whygo"></a>
</h2>

<p>I'm going to focus on running a build for a Lambda function written in Go in this post, but many of the same techniques could be leveraged for any kind of asset bundling. Go is a language that compiles to a binary while TypeScript compiles to JavaScript, so we're dipping our toes in very different worlds here. I've only recently begun to properly learn Go  (thanks <a href="https://cloudacademy.com/">Cloud Academy</a>), so I've got a mix of googled hacks and assumed best practices. That's good enough to bundle into a CDK project.</p>

<p>I used Go for a recent exploration of <a href="">Open Policy Agent</a> in my <a href="https://rego.fyi">rego.fyi</a> website. I'm going to show snippets from that app. <a href="https://github.com/elthrasher/rego.fyi">The full repo can be found here</a>.</p>

<h2>
  <a name="asset-hash" href="#asset-hash">
  </a>
  Asset Hash<a name="asset-hash"></a>
</h2>

<p>Let's start with the best part first. The <code>AssetOptions</code> interface has three optional properties: <code>assetHash</code>, <code>assetHashType</code> and <code>bundling</code>. In fact, giving the asset options is optional. We can simply write:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="nx">Code</span><span class="p">.</span><span class="nx">fromAsset</span><span class="p">(</span><span class="dl">'</span><span class="s1">/path/to/my/stuff</span><span class="dl">'</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>This will add the specified path as an asset. It isn't modified at all and the input path will be used to detect changes. The above code can be part of a Lambda function. Example:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Code</span><span class="p">,</span> <span class="nb">Function</span> <span class="k">as</span> <span class="nx">LambdaFunction</span><span class="p">,</span> <span class="nx">Runtime</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@aws-cdk/aws-lambda</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>

<span class="k">new</span> <span class="nx">LambdaFunction</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">'</span><span class="s1">myFn</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">code</span><span class="p">:</span> <span class="nx">Code</span><span class="p">.</span><span class="nx">fromAsset</span><span class="p">(</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">handler</span><span class="dl">'</span><span class="p">)),</span>
  <span class="na">runtime</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">NODEJS_14_X</span><span class="p">,</span>
  <span class="na">handler</span><span class="p">:</span> <span class="dl">'</span><span class="s1">index.handler</span><span class="dl">'</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>or it could just be an asset you want uploaded to S3:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Asset</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@aws-cdk/aws-s3-assets</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>

<span class="k">new</span> <span class="nx">Asset</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MyAsset</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">path</span><span class="p">:</span> <span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">myfile.txt</span><span class="dl">'</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>There's obviously a difference here. <code>Code.fromAsset</code> takes the path as the first arg, then has an optional <code>AssetOptions</code> argument while <code>new Asset</code> is declared as a standalone construct that requires a scope and an id. The <code>Asset</code> construct takes a required third argument of <code>AssetProps</code> which extends <code>AssetOptions</code> but adds the required <code>path</code> property.</p>

<p>But wait there's more! You might be bundling for an S3 website.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">BucketDeployment</span><span class="p">,</span> <span class="nx">Source</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@aws-cdk/aws-s3-deployment</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>

<span class="k">new</span> <span class="nx">BucketDeployment</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="dl">'</span><span class="s1">DeployWebsite</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">destinationBucket</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Bucket</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="dl">'</span><span class="s1">WebsiteBucket</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">autoDeleteObjects</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">publicReadAccess</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">removalPolicy</span><span class="p">:</span> <span class="nx">RemovalPolicy</span><span class="p">.</span><span class="nx">DESTROY</span><span class="p">,</span>
    <span class="na">websiteIndexDocument</span><span class="p">:</span> <span class="dl">'</span><span class="s1">index.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">}),</span>
  <span class="nx">distribution</span><span class="p">,</span>
  <span class="na">distributionPaths</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">/*</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">sources</span><span class="p">:</span> <span class="p">[</span><span class="nx">Source</span><span class="p">.</span><span class="nx">asset</span><span class="p">(</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">../path/to/asset</span><span class="dl">'</span><span class="p">))],</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Or maybe you're building a Docker image?<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">DockerImageAsset</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@aws-cdk/aws-ecr-assets</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>

<span class="k">new</span> <span class="nx">DockerImageAsset</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MyBuildImage</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">directory</span><span class="p">:</span> <span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">my-image</span><span class="dl">'</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Seems confusing? It's actually not that bad. We have a common interface used for building Lambda functions, miscellaneous assets, S3 websites, Docker images and anything else you may wish to transform in a build pipeline. Now that that's clear, let's dig into that <code>AssetOptions</code> interface.</p>

<p>The <code>assetHash</code> property would be appropriate if you wanted to generate your own hash instead of letting CDK manage that for you. Most of the time you won't want to use this, but it's good it's there if you need it.</p>

<p>I'm more interested in <code>assetHashType</code>. We get a couple of options to consider: <code>OUTPUT</code> and <code>SOURCE</code>. There is also <code>BUNDLE</code>, deprecated by <code>OUTPUT</code>, and <code>CUSTOM</code>, which just means <code>assetHash</code> is provided. Between <code>OUTPUT</code> and <code>SOURCE</code>, <code>SOURCE</code> is the default, but I think I prefer <code>OUTPUT</code>. If my inputs change (perhaps a library bump) but my output doesn't (that library bump had no impact on the bundled code), then do I really want to deploy new code?</p>

<p>I'll go into another reason for preferring <code>OUTPUT</code> later in the article. The takeaway here is we have a lot of flexibility to hash the input, output or provide our own hash. That's great because controlling this feature will make deployments faster. We'll spend less time staring at <a href="http://progressquest.com/">progress bars</a> and we'll also be able to respond more quickly to operational issues. This will speed up our dev cycle as well. It's a great feeling running a stack with 11 Lambda Functions, making a change to just one of them and then having a very quick deployment as CDK identifies the one that changed and deploys an update only for that one.</p>

<h2>
  <a name="local-bundling" href="#local-bundling">
  </a>
  Local Bundling<a name="local-bundling"></a>
</h2>

<p>Let's move onto the final optional property of <code>AssetOptions</code>, bundling. We're going to need to use this if we want to run any kind of build or compilation process on our code. We <em>could</em> run that as a separate process and then use the output of that process as our asset, but doing it as part of the CDK build is much better.</p>

<p>The default for bundling is to use Docker, even if you aren't aiming to produce an image. This makes sense for some purposes and will cause problems for others. If our build environment runs a different operating system than our production environment and we are compiling binaries, we may need Docker builds. On the other hand, we might be building in an environment that doesn't run Docker. We could even be building in a Docker environment where spawning a new container from the current one (Docker-in-Docker) is not allowed!</p>

<p>Let's start from a place where we do <strong>not</strong> want to use Docker. Unfortunately we can't just leave Docker out entirely. The <code>image</code> property of <code>bundling</code> is required. Instead let's just let the user know that we aren't supporting a Docker build.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">new</span> <span class="nx">LambdaFunction</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MyFn</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">code</span><span class="p">:</span> <span class="nx">Code</span><span class="p">.</span><span class="nx">fromAsset</span><span class="p">(</span><span class="nx">myPath</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">assetHashType</span><span class="p">:</span> <span class="nx">AssetHashType</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span>
      <span class="na">bundling</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">command</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">sh</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-c</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">echo "Docker build not supported. Please install go."</span><span class="dl">'</span><span class="p">],</span>
        <span class="na">image</span><span class="p">:</span> <span class="nx">DockerImage</span><span class="p">.</span><span class="nx">fromRegistry</span><span class="p">(</span><span class="dl">'</span><span class="s1">alpine</span><span class="dl">'</span><span class="p">),</span>
      <span class="p">},</span>
    <span class="p">}),</span>
    <span class="na">handler</span><span class="p">:</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">runtime</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">GO_1_X</span><span class="p">,</span>
  <span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>If local bundling fails, now we at least have a meaningful error message to the user. Of course the above code will fail every build, so we have more work to do. Let's add local bundling. The <code>local</code> property of <code>bundling</code> must implement <code>ILocalBundling</code>, an object with one method, <code>tryBundle</code> that receives the <code>outputDir</code> as an argument and must return a boolean type. If <code>tryBundle</code> returns true and some code artifact is found in <code>outputDir</code>, then CDK will see the build as successful and skip the Docker build. <code>tryBundle</code> is synchronous and will not resolve promises so we need a strategy for running the build synchronously and accurately reporting whether or not it was successful.</p>

<p>To synchronously run our build, we'll use <code>execSync</code> from the nodejs <a href="https://nodejs.org/dist/latest-v14.x/docs/api/child_process.html#child_process_child_process_execsync_command_options">child_process</a> module. <code>tryBundle</code> should implement try/catch to ensure it returns a boolean about the state of our build. It's common practice to execute some kind of test to see if the runtime supports our build. We could use <code>go version</code> to see if our runtime can support a build in Go.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Code</span><span class="p">,</span> <span class="nb">Function</span> <span class="k">as</span> <span class="nx">LambdaFunction</span><span class="p">,</span> <span class="nx">Runtime</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@aws-cdk/aws-lambda</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AssetHashType</span><span class="p">,</span> <span class="nx">DockerImage</span><span class="p">,</span> <span class="nx">Stack</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@aws-cdk/core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">execSync</span><span class="p">,</span> <span class="nx">ExecSyncOptions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">child_process</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">execOptions</span><span class="p">:</span> <span class="nx">ExecSyncOptions</span> <span class="o">=</span> <span class="p">{</span> <span class="na">stdio</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">ignore</span><span class="dl">'</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="dl">'</span><span class="s1">inherit</span><span class="dl">'</span><span class="p">]</span> <span class="p">};</span>
<span class="kd">const</span> <span class="nx">goPath</span> <span class="o">=</span> <span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">..</span><span class="dl">'</span><span class="p">);</span>

<span class="k">new</span> <span class="nx">LambdaFunction</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MyFn</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">code</span><span class="p">:</span> <span class="nx">Code</span><span class="p">.</span><span class="nx">fromAsset</span><span class="p">(</span><span class="nx">goPath</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">assetHashType</span><span class="p">:</span> <span class="nx">AssetHashType</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span>
      <span class="na">bundling</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">command</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">sh</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-c</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">echo "Docker build not supported. Please install go."</span><span class="dl">'</span><span class="p">],</span>
        <span class="na">image</span><span class="p">:</span> <span class="nx">DockerImage</span><span class="p">.</span><span class="nx">fromRegistry</span><span class="p">(</span><span class="dl">'</span><span class="s1">alpine</span><span class="dl">'</span><span class="p">),</span>
      <span class="p">},</span>
      <span class="na">local</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">tryBundle</span><span class="p">(</span><span class="na">outputDir</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">try</span> <span class="p">{</span>
            <span class="nx">execSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">go version</span><span class="dl">'</span><span class="p">,</span> <span class="nx">execOptions</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">execSync</span><span class="p">(</span><span class="s2">`GOARCH=amd64 GOOS=linux go build -ldflags="-s -w" -o </span><span class="p">${</span><span class="nx">join</span><span class="p">(</span><span class="nx">outputDir</span><span class="p">,</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span>
            <span class="p">...</span><span class="nx">execOptions</span><span class="p">,</span>
            <span class="na">cwd</span><span class="p">:</span> <span class="nx">join</span><span class="p">(</span><span class="nx">goPath</span><span class="p">,</span> <span class="dl">'</span><span class="s1">fns/go</span><span class="dl">'</span><span class="p">),</span>
          <span class="p">});</span>
          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}),</span>
    <span class="na">handler</span><span class="p">:</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">runtime</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">GO_1_X</span><span class="p">,</span>
  <span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I've included some options for standard output from <code>execSync</code> that work well for me on my terminal. For this project, I've structured things in such a way that my <code>go.mod</code> and <code>go.sum</code> are in the root of my project and my go source is in <code>fns/go</code>. Because of that, I need to set the path of the build to the project root, then run the build command in <code>fns/go</code>.</p>

<p>For the uninitiated, <code>go.mod</code> and <code>go.sum</code> are for dependency management using <a href="https://blog.golang.org/using-go-modules">go modules</a>. This is not completely unlike <code>package.json</code> and <code>package-lock.json</code>. I'm not crystal clear on best practices myself, but it does seem like these belong in the root. It is also typical to put a <code>main.go</code> file in the root of a project, but that felt wrong for a polyglot project. By putting my dependency files in the root and my function code in directory parallel to <code>fns/ts</code> (for TypeScript), I'm able to run my tests from the root of the project with <code>go test ./...</code>, while organizing my project in a way that makes sense to me.</p>

<p>This is why setting <code>AssetHashType</code> to <code>OUTPUT</code> is so important, because I'm actually setting my source to the root of the project and I do not want to use the entire project as change detection for this one function.</p>

<p>In summation, I've organized my project in a way that makes sense to me and seems efficient. Is it the best practice? You tell me. I spent some time searching for answers and couldn't come up with one.</p>

<p>A couple of other things to mention here about the build. Using local bundling, I very well may be running a build in an environment (MacOS in this case) that is different than my execution environment (Lambda, which is Amazon Linux). If I don't run a build that targets my environment, it's not going to work. Fortunately Go has me covered and by adding the <code>GOARCH=amd64 GOOS=linux</code> flags to my build, I'll target the right architecture and OS. As for <code>ldflags</code>, I admit that's a copy-paste. I read the docs and I'm still not sure why I'm doing it! Maybe it'll dawn on me some day.</p>

<p>Finally, I do have the option of making <code>tryBundle</code> a little more concise. Since <code>execSync</code> will correctly throw an error if my build fails, I could skip <code>go version</code> and just write:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="nx">tryBundle</span><span class="p">(</span><span class="nx">outputDir</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">execSync</span><span class="p">(</span><span class="s2">`GOARCH=amd64 GOOS=linux go build -ldflags="-s -w" -o </span><span class="p">${</span><span class="nx">join</span><span class="p">(</span><span class="nx">outputDir</span><span class="p">,</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span>
      <span class="p">...</span><span class="nx">execOptions</span><span class="p">,</span>
      <span class="na">cwd</span><span class="p">:</span> <span class="nx">join</span><span class="p">(</span><span class="nx">goPath</span><span class="p">,</span> <span class="dl">'</span><span class="s1">fns/go</span><span class="dl">'</span><span class="p">),</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">},</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>It's just a matter of taste here. Do you like the go version being output?</p>

<h2>
  <a name="docker-bundling" href="#docker-bundling">
  </a>
  Docker Bundling<a name="docker-bundling"></a>
</h2>

<p>Docker bundling could well be appropriate if we don't want to install Go on the build system. Using Docker builds might allow a polyglot app to be checked out and worked on by developers who don't use every language in the app. It might also work out well for apps written in languages that have many different versions available that could be on contributors' workstations. The Docker build could pin us to specific languages and versions. Let's see how that looks.</p>

<p>We have already provided the <code>command</code> and <code>image</code> arguments to shy users away from Docker. Now we'll flip it around and use those commands to run a Docker build. First we need a base image other than <code>alpine</code>. CDK is able to provide a suggestion here. The <code>Runtime</code> constant exposes a <code>bundlingDockerImage</code> for each available runtime.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="nx">bundling</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">command</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">sh</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-c</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">echo "Need a command"</span><span class="dl">'</span><span class="p">],</span>
  <span class="nx">image</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">GO_1_X</span><span class="p">.</span><span class="nx">bundlingDockerImage</span><span class="p">,</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>For the NodeJS, Python, Java and some DotNet runtimes, this image will point to <code>amazon/aws-sam-cli-build-image-*</code> images, that are now maintained by the <a href="https://aws.amazon.com/serverless/sam/">AWS SAM</a> project. For whatever reason, the Go image still (at the time of this writing) uses <code>lambci/lambda:build-go1.x</code> from Michael Hart's <a href="https://www.lambci.org/">lambci</a> project that originally inspired SAM. This image is perfectly good for my purposes, but by using a CDK constant, I do run the risk that some day this changes to another image, so I should keep an eye on that.</p>

<p>The way the Docker build works here is CDK will automatically map a volume of my build path (specified as the first argument of <code>fromAsset</code>) to <code>/asset-input</code> in the container. My build is expected to produce output to <code>/asset-output</code> in order to be considered successful.</p>

<p>As I noted above, my dependency files (<code>go.mod</code> and <code>go.sum</code>) are in the root of my project, so I need to set the input to the root of my project and the entire project is shared as volume. This is a little inefficient, but still relatively fast. The entire build is taking less than 20 seconds on my MBP.</p>

<p>To make this work, we'll set the <code>user</code> and <code>workingDirectory</code> properties. For <code>workingDirectory</code>, we can map right into the directory with the go files <code>/asset-input/fns/go</code> and save ourselves a clumsy <code>cd</code> in the command. We'll also need to specify the user as <code>root</code> in order to create the go cache. For those experienced in Docker, this will stick out as a problem, but running a build as root isn't a big deal so long as we aren't running a production workload as root.</p>

<p>Finally we set the command to basically the same thing we had for local bundling and now we have a working build!<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="nx">bundling</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">command</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">sh</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-c</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">GOARCH=amd64 GOOS=linux go build -ldflags="-s -w" -o /asset-output/main</span><span class="dl">'</span><span class="p">],</span>
  <span class="nx">image</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">GO_1_X</span><span class="p">.</span><span class="nx">bundlingDockerImage</span><span class="p">,</span>
  <span class="nx">user</span><span class="p">:</span> <span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">workingDirectory</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/asset-input/fns/go</span><span class="dl">'</span><span class="p">,</span>
<span class="p">},</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Specifying the architecture and OS may not be necessary since we should be building in a Lambda-friendly environment, but it also doesn't hurt. Notice the build outputs directly to <code>/asset-output/main</code>. From there, CDK picks up the artifact and stages it for upload. You'll be able to see it under <code>cdk.out</code>.</p>

<h2>
  <a name="byo-dockerfile" href="#byo-dockerfile">
  </a>
  BYO Dockerfile<a name="byo-dockerfile"></a>
</h2>

<p>If you're at all picky about your Docker builds, you probably want to provide your own Dockerfile. Of course you can! This is most emphatically <strong>not</strong> an article on Docker best practices, but I took at shot at building a Dockerfile that ticks at least most of the boxes.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight docker"><code><span class="k">FROM</span><span class="s"> lambci/lambda:build-go1.x</span>

<span class="k">ENV</span><span class="s"> APP_USER app</span>
<span class="k">ENV</span><span class="s"> APP_HOME /usr/app</span>
<span class="k">ENV</span><span class="s"> ASSET_DIR /asset</span>
<span class="k">ENV</span><span class="s"> GOPATH $APP_HOME/go</span>
<span class="k">ENV</span><span class="s"> GOARCH=amd64 GOOS=linux </span>
<span class="k">RUN </span>groupadd <span class="nv">$APP_USER</span> <span class="o">&amp;&amp;</span> useradd <span class="nt">-m</span> <span class="nt">-g</span> <span class="nv">$APP_USER</span> <span class="nt">-l</span> <span class="nv">$APP_USER</span>
<span class="k">RUN </span><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$APP_HOME</span> <span class="o">&amp;&amp;</span> <span class="nb">chown</span> <span class="nt">-R</span> <span class="nv">$APP_USER</span>:<span class="nv">$APP_USER</span> <span class="nv">$APP_HOME</span>
<span class="k">RUN </span><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$ASSET_DIR</span> <span class="o">&amp;&amp;</span> <span class="nb">chown</span> <span class="nt">-R</span> <span class="nv">$APP_USER</span>:<span class="nv">$APP_USER</span> <span class="nv">$ASSET_DIR</span>
<span class="k">WORKDIR</span><span class="s"> $APP_HOME</span>
<span class="k">USER</span><span class="s"> $APP_USER</span>

<span class="k">COPY</span><span class="s"> go.mod go.sum ./</span>

<span class="k">RUN </span>go mod download <span class="o">&amp;&amp;</span> go mod verify

<span class="k">COPY</span><span class="s"> /fns/go/authorizer.go ./</span>

<span class="k">RUN </span>go build <span class="nt">-ldflags</span><span class="o">=</span><span class="s2">"-s -w"</span> <span class="nt">-o</span> <span class="nv">$ASSET_DIR</span>/main
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I'm using a non-root user, caching dependencies and explicitly using <code>COPY</code> instead of sharing the volume. Is that perfect? The point is you can build your own according to whatever practices you follow and CDK isn't going to silently share volumes or try to run as a particular user.</p>

<p>Implementing this Dockerfile is pretty easy too. We can simply do this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">new</span> <span class="nx">LambdaFunction</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="dl">'</span><span class="s1">AuthZFun</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">code</span><span class="p">:</span> <span class="nx">Code</span><span class="p">.</span><span class="nx">fromDockerBuild</span><span class="p">(</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">..</span><span class="dl">'</span><span class="p">)),</span>
  <span class="na">handler</span><span class="p">:</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">runtime</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">GO_1_X</span><span class="p">,</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>One gotcha here is that you <strong>must</strong> use an absolute path to your Dockerfile. I don't know why this is. It seems like a bug, as Docker can certainly build off a relative path, but when I try it my build fails with <code>GlobIgnoreStrategy expects an absolute file path</code>. Just use the full path and you'll be fine.</p>

<p>What about combining local bundling and a fallback to a Dockerfile? Sure, we can support that!<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">new</span> <span class="nx">LambdaFunction</span><span class="p">(</span><span class="nx">stack</span><span class="p">,</span> <span class="dl">'</span><span class="s1">AuthZFun</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">code</span><span class="p">:</span> <span class="nx">Code</span><span class="p">.</span><span class="nx">fromAsset</span><span class="p">(</span><span class="nx">goPath</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">assetHashType</span><span class="p">:</span> <span class="nx">AssetHashType</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span>
    <span class="na">bundling</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">command</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">sh</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-c</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cp /asset/main /asset-output/main</span><span class="dl">'</span><span class="p">],</span>
      <span class="na">image</span><span class="p">:</span> <span class="nx">DockerImage</span><span class="p">.</span><span class="nx">fromBuild</span><span class="p">(</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">..</span><span class="dl">'</span><span class="p">)),</span>
      <span class="na">local</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">tryBundle</span><span class="p">(</span><span class="na">outputDir</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">try</span> <span class="p">{</span>
            <span class="nx">execSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">go version</span><span class="dl">'</span><span class="p">,</span> <span class="nx">execOptions</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">catch</span> <span class="cm">/* istanbul ignore next */</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">execSync</span><span class="p">(</span><span class="s2">`GOARCH=amd64 GOOS=linux go build -ldflags="-s -w" -o </span><span class="p">${</span><span class="nx">join</span><span class="p">(</span><span class="nx">outputDir</span><span class="p">,</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span>
            <span class="p">...</span><span class="nx">execOptions</span><span class="p">,</span>
            <span class="na">cwd</span><span class="p">:</span> <span class="nx">join</span><span class="p">(</span><span class="nx">goPath</span><span class="p">,</span> <span class="dl">'</span><span class="s1">fns/go</span><span class="dl">'</span><span class="p">),</span>
          <span class="p">});</span>
          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">},</span>
      <span class="p">},</span>
      <span class="na">workingDirectory</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/usr/app</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">}),</span>
  <span class="na">handler</span><span class="p">:</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">runtime</span><span class="p">:</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">GO_1_X</span><span class="p">,</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Using the same Dockerfile, we now need to set our workingDirectory to <code>/usr/app</code>, as specified by the Dockerfile. Otherwise, it'll default to <code>/asset-input</code>. Unfortunately this method will still do the (here unneeded and unnecessary) volume share, but we can dead-end that by ignoring the share in our Docker build. Note that we do need this command to copy our build from <code>/asset/main</code> to <code>/asset-output/main</code>. For one thing, the output dir isn't configurable in this build and for another, because the output is being delivered via another Docker share, just running the build won't do anything, even if the we output to <code>/asset-output/main</code> during the Docker build. That's because the volume share doesn't happen until the built image is run with that command.</p>

<h2>
  <a name="conclusion" href="#conclusion">
  </a>
  Conclusion<a name="conclusion"></a>
</h2>

<p>All this said and done, I still prefer local builds and focus on those in my own work, but it's definitely useful to understand the other builds that are available here. I had a tough time figuring out some of the ins and outs of managing Docker builds.</p>

<p>I've said before that I find the API for bundling a little less intuitive than it needs to be, but the output is excellent. I can make a change to my stack, say, modifying the API Gateway <code>throttlingRateLimit</code>. Then when I deploy, I'm treated to something like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code>regofyi: creating CloudFormation changeset...
<span class="o">[</span>··························································] <span class="o">(</span>0/2<span class="o">)</span>

8:43:31 PM | UPDATE_IN_PROGRESS   | AWS::CloudFormation::Stack           | regofyi
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Even though all my code was re-bundled, CDK correctly determined the build output hadn't changed, so it wasn't included in the changeset and I wound up with a really simple deployment.</p>

<p><a href="https://picryl.com/media/frieze-with-sea-monsters-778b2f">COVER IMAGE</a></p>

</div></article> <div class="aside-username-wrapper" data-v-3bf13c85><aside class="aside-username-block" data-v-29ea5fa2 data-v-3bf13c85><div class="username-heading loading" data-v-29ea5fa2><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-29ea5fa2><div class="vue-content-placeholders-heading" data-v-29ea5fa2><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-29ea5fa2><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-29ea5fa2><div class="vue-content-placeholders-text" data-v-29ea5fa2><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-54aa1ab4 data-v-3bf13c85><!----> <a href="https://dev.to/elthrasher/aws-cdk-fullstack-polyglot-with-asset-bundling-318h" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-54aa1ab4>
    Add comment
  </a></div></div> <footer class="w-full py-8"><div class="max-w-screen-xl mx-auto px-4"><ul class="
        max-w-screen-md
        mx-auto
        text-lg
        font-light
        md:flex flex-wrap
        md:justify-between

      "><li class="my-2"><a href="#" class="
            text-gray-400
            hover:text-gray-800
            dark:text-gray-300 dark:hover:text-white
            transition-colors
            duration-200
          ">
          FAQ
        </a></li> <li class="my-2"><a href="#" class="
            text-gray-400
            hover:text-gray-800
            dark:text-gray-300 dark:hover:text-white
            transition-colors
            duration-200
          ">
          Configuration
        </a></li> <li class="my-2"><a href="#" class="
            text-gray-400
            hover:text-gray-800
            dark:text-gray-300 dark:hover:text-white
            transition-colors
            duration-200
          ">
          Github
        </a></li> <li class="my-2"><a href="#" class="
            text-gray-400
            hover:text-gray-800
            dark:text-gray-300 dark:hover:text-white
            transition-colors
            duration-200
          ">
          LinkedIn
        </a></li></ul> <div class="pt-8 flex max-w-xs mx-auto items-center justify-between"><a href="#" class="
          text-gray-400
          hover:text-gray-800
          dark:hover:text-white
          transition-colors
          duration-200
        "><svg width="20" height="20" fill="currentColor" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="
            text-xl
            hover:text-gray-800
            dark:hover:text-white
            transition-colors
            duration-200
          "><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"></path></svg></a> <a href="#" class="
          text-gray-400
          hover:text-gray-800
          dark:hover:text-white
          transition-colors
          duration-200
        "><svg width="20" height="20" fill="currentColor" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="
            text-xl
            hover:text-gray-800
            dark:hover:text-white
            transition-colors
            duration-200
          "><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path></svg></a> <a href="#" class="
          text-gray-400
          hover:text-gray-800
          dark:hover:text-white
          transition-colors
          duration-200
        "><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 1792 1792" class="
            text-xl
            hover:text-gray-800
            dark:hover:text-white
            transition-colors
            duration-200
          "><path d="M896 128q209 0 385.5 103t279.5 279.5 103 385.5q0 251-146.5 451.5t-378.5 277.5q-27 5-40-7t-13-30q0-3 .5-76.5t.5-134.5q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-119-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-85-13.5q-45 113-8 204-79 87-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-39 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 88.5t.5 54.5q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103zm-477 1103q3-7-7-12-10-3-13 2-3 7 7 12 9 6 13-2zm31 34q7-5-2-16-10-9-16-3-7 5 2 16 10 10 16 3zm30 45q9-7 0-19-8-13-17-6-9 5 0 18t17 7zm42 42q8-8-4-19-12-12-20-3-9 8 4 19 12 12 20 3zm57 25q3-11-13-16-15-4-19 7t13 15q15 6 19-6zm63 5q0-13-17-11-16 0-16 11 0 13 17 11 16 0 16-11zm58-10q-2-11-18-9-16 3-14 15t18 8 14-14z"></path></svg></a> <a href="#" class="
          text-gray-400
          hover:text-gray-800
          dark:hover:text-white
          transition-colors
          duration-200
        "><svg width="20" height="20" fill="currentColor" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="
            text-xl
            hover:text-gray-800
            dark:hover:text-white
            transition-colors
            duration-200
          "><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"></path></svg></a> <a href="#" class="
          text-gray-400
          hover:text-gray-800
          dark:hover:text-white
          transition-colors
          duration-200
        "><svg width="20" height="20" fill="currentColor" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="
            text-xl
            hover:text-gray-800
            dark:hover:text-white
            transition-colors
            duration-200
          "><path d="M1551 1476q15-6 26-3t11 17.5-15 33.5q-13 16-44 43.5t-95.5 68-141 74-188 58-229.5 24.5q-119 0-238-31t-209-76.5-172.5-104-132.5-105-84-87.5q-8-9-10-16.5t1-12 8-7 11.5-2 11.5 4.5q192 117 300 166 389 176 799 90 190-40 391-135zm207-115q11 16 2.5 69.5t-28.5 102.5q-34 83-85 124-17 14-26 9t0-24q21-45 44.5-121.5t6.5-98.5q-5-7-15.5-11.5t-27-6-29.5-2.5-35 0-31.5 2-31 3-22.5 2q-6 1-13 1.5t-11 1-8.5 1-7 .5h-10l-3-.5-2-1.5-1.5-3q-6-16 47-40t103-30q46-7 108-1t76 24zm-394-443q0 31 13.5 64t32 58 37.5 46 33 32l13 11-227 224q-40-37-79-75.5t-58-58.5l-19-20q-11-11-25-33-38 59-97.5 102.5t-127.5 63.5-140 23-137.5-21-117.5-65.5-83-113-31-162.5q0-84 28-154t72-116.5 106.5-83 122.5-57 130-34.5 119.5-18.5 99.5-6.5v-127q0-65-21-97-34-53-121-53-6 0-16.5 1t-40.5 12-56 29.5-56 59.5-48 96l-294-27q0-60 22-119t67-113 108-95 151.5-65.5 190.5-24.5q100 0 181 25t129.5 61.5 81 83 45 86 12.5 73.5v589zm-672 21q0 86 70 133 66 44 139 22 84-25 114-123 14-45 14-101v-162q-59 2-111 12t-106.5 33.5-87 71-32.5 114.5z"></path></svg></a></div> <div class="
        text-center
        pt-10
        sm:pt-12
        font-light
        flex
        items-center
        justify-center
      "><form class="
          flex flex-col
          md:flex-row
          w-3/4
          md:w-full
          max-w-sm
          md:space-x-3
          space-y-3
          md:space-y-0
          justify-center
        "><div class="relative"><input type="text" id=""form-subscribe-Subscribe" placeholder="Email" class="
              rounded-lg
              border-transparent
              flex-1
              appearance-none
              border border-gray-300
              w-full
              py-2
              px-4
              bg-white
              text-gray-700
              placeholder-gray-400
              shadow-sm
              text-base
              focus:outline-none
              focus:ring-2
              focus:ring-gray-400
              focus:border-transparent
            "></div> <button type="submit" class="
            flex-shrink-0
            px-4
            py-2
            text-black
            font-semibold
            bg-white
            rounded-lg
            shadow-md
            hover:bg-gray-800 hover:text-white
            focus:outline-none
            focus:ring-2
            focus:ring-white
            focus:ring-offset-2
            focus:ring-offset-white
          ">
          Subscribe
        </button></form></div> <div class="
        text-center text-gray-500
        dark:text-gray-200
        pt-10
        sm:pt-12
        font-light
        flex
        items-center
        justify-center
      ">
      Created by Samar
    </div></div></footer></div></div></div><script defer src="/_nuxt/static/1634322943/articles/elthrasher/641503/state.js"></script><script src="/_nuxt/548109a.js" defer></script><script src="/_nuxt/c3ddcce.js" defer></script><script src="/_nuxt/84567ea.js" defer></script><script src="/_nuxt/ad2e88f.js" defer></script><script src="/_nuxt/a9b0fbe.js" defer></script>
  </body>
</html>
