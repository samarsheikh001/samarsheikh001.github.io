window.__NUXT__=(function(a,b,c,d,e){return {staticAssetsBase:"\u002F_nuxt\u002Fstatic\u002F1634322943",layout:"default",error:a,state:{currentArticle:{type_of:"article",id:640468,title:"Turn a Google Sheet into a REST API",description:"Turn your Google Sheet into a REST API and access it in any application.    This blog was...",readable_publish_date:"Mar 24",slug:"turn-a-google-sheet-into-a-rest-api-4pnl",path:"\u002Fravgeetdhillon\u002Fturn-a-google-sheet-into-a-rest-api-4pnl",url:"https:\u002F\u002Fdev.to\u002Fravgeetdhillon\u002Fturn-a-google-sheet-into-a-rest-api-4pnl",comments_count:0,public_reactions_count:c,collection_id:a,published_timestamp:d,positive_reactions_count:c,cover_image:"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--QAb2hyH6--\u002Fc_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000\u002Fhttps:\u002F\u002Fwww.ravsam.in\u002Fassets\u002Fimages\u002Fblogs\u002Fturning-a-google-sheet-into-a-rest-api.png",social_image:"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--vgZv8gS2--\u002Fc_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000\u002Fhttps:\u002F\u002Fwww.ravsam.in\u002Fassets\u002Fimages\u002Fblogs\u002Fturning-a-google-sheet-into-a-rest-api.png",canonical_url:"https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fturning-a-google-sheet-into-a-rest-api\u002F",created_at:"2021-03-20T11:36:34Z",edited_at:"2021-08-27T13:05:30Z",crossposted_at:d,published_at:e,last_comment_at:e,reading_time_minutes:4,tag_list:"restapi, googleappsscript, webapps",tags:["restapi","googleappsscript","webapps"],body_html:"\u003Ch4\u003E\n  \u003Ca name=\"turn-your-google-sheet-into-a-rest-api-and-access-it-in-any-application\" href=\"#turn-your-google-sheet-into-a-rest-api-and-access-it-in-any-application\"\u003E\n  \u003C\u002Fa\u003E\n  Turn your Google Sheet into a REST API and access it in any application.\n\u003C\u002Fh4\u003E\n\n\u003Cblockquote\u003E\n\u003Cp\u003EThis blog was originally published on \u003Ca href=\"https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fturning-a-google-sheet-into-a-rest-api\u002F\"\u003ERavSam’s blog\u003C\u002Fa\u003E. We publish our articles on Medium after a week.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\n\u003Cp\u003EWhat if we can use our Google Sheets as a CMS? What if we want the data in our Google Sheet to be publicly available. This can be done easily using Google Sheets and Google Apps Script. In this blog, we will take a look at how we can convert a Google Sheet into a REST API and access it publicly from any app we want.\u003C\u002Fp\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"contents\" href=\"#contents\"\u003E\n  \u003C\u002Fa\u003E\n  Contents\n\u003C\u002Fh4\u003E\n\n\u003Cul\u003E\n\u003Cli\u003E\u003Col\u003E\n\u003Cli\u003ESetting up a Spreadsheet\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Col\u003E\n\u003Cli\u003ECreating a Google Apps Script\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Col\u003E\n\u003Cli\u003EConverting data to JSON format\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Col\u003E\n\u003Cli\u003ECreating a Web App\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003EResults\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"1-setting-up-a-spreadsheet\" href=\"#1-setting-up-a-spreadsheet\"\u003E\n  \u003C\u002Fa\u003E\n  1. Setting up a Spreadsheet\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003EThe first task is to set up a Spreadsheet and initialize it with some data.\u003C\u002Fp\u003E\n\n\u003Cp\u003E\u003Cfigure\u003E\u003Ca href=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--VM1xGg8m--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1024\u002F0%2ANa68HQ21zRGTVqbu.png\" class=\"article-body-image-wrapper\"\u003E\u003Cimg src=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--VM1xGg8m--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1024\u002F0%2ANa68HQ21zRGTVqbu.png\" alt=\"Format for Google Spreadsheet\" loading=\"lazy\"\u003E\u003C\u002Fa\u003E\u003Cfigcaption\u003EGoogle Spreadsheet with some data\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003C\u002Fp\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"2-creating-a-google-apps-script\" href=\"#2-creating-a-google-apps-script\"\u003E\n  \u003C\u002Fa\u003E\n  2. Creating a Google Apps Script\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003EThe first step in our journey to convert the above Google Sheet into a REST API is to be able to access the data in it. So, from \u003Cem\u003ETools\u003C\u002Fem\u003E, select \u003Cem\u003EScript Editor\u003C\u002Fem\u003E. This will create a new Apps Script project.\u003C\u002Fp\u003E\n\n\u003Cp\u003ELet us start by adding the following snippet of code in the Code.gs file.\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight javascript\"\u003E\u003Ccode\u003E\u003Cspan class=\"kd\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ejson\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EsheetName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Espreadsheet\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003ESpreadsheetApp\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EgetActiveSpreadsheet\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Esheet\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Espreadsheet\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EgetSheetByName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EsheetName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Edata\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Esheet\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EgetDataRange\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E().\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EgetValues\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003EjsonData\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003EconvertToJson\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Edata\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003EContentService\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EcreateTextOutput\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Estringify\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EjsonData\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E))\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EsetMimeType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EContentService\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EMimeType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThe above function is really simple to understand. All we are doing is:\u003C\u002Fp\u003E\n\n\u003Cul\u003E\n\u003Cli\u003E\u003Cp\u003EGet the current active spreadsheet to which this Apps Script project is linked with\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003EGet our specific sheet by its name\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003EGet the data in that sheet\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003EConvert the data to JSON format\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003EReturn the JSON response\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"3-converting-data-to-json-format\" href=\"#3-converting-data-to-json-format\"\u003E\n  \u003C\u002Fa\u003E\n  3. Converting data to JSON format\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003EThe data returned by the sheet.getDataRange().getValues() is of the following format:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight javascript\"\u003E\u003Ccode\u003E\u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003Ename\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003Eage\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003Erole\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E],\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003EJohn\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mf\"\u003E28.0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003EFront End Engineer\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E],\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003EMarry\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mf\"\u003E21.0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003EStaff Engineer\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E],\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003EJackson\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mf\"\u003E22.0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003EBackend Engineer\u003C\u002Fspan\u003E\u003Cspan class=\"dl\"\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EIn the above snippet, we can see that there is a custom function convertToJson that needs to be written. To convert our sheet data with headers into JSON format, let us the following code in our Apps Script.\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight javascript\"\u003E\u003Ccode\u003E\u003Cspan class=\"kd\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003EconvertToJson\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Edata\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Eheaders\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Edata\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Eraw_data\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Edata\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Eslice\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ejson\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E[]\u003C\u002Fspan\u003E\n  \u003Cspan class=\"nx\"\u003Eraw_data\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003EforEach\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Ed\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"kd\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Eobject\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"k\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kd\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ei\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ei\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Eheaders\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Elength\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"nx\"\u003Eobject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Eheaders\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]]\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n      \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n      \u003Cspan class=\"nx\"\u003Ejson\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Epush\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Eobject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"p\"\u003E});\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ejson\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Ch4\u003E\n  \u003Ca name=\"4-creating-a-web-app\" href=\"#4-creating-a-web-app\"\u003E\n  \u003C\u002Fa\u003E\n  4. Creating a Web App\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003ETo access our Google Sheet as a REST API, we need to publish our Google Apps Script as a Web App. This web app will handle \u003Cstrong\u003EGET requests\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\n\u003Cp\u003ELet us add the following code in our Apps Script file:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight javascript\"\u003E\u003Ccode\u003E\u003Cspan class=\"kd\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003EdoGet\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"kd\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Epath\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Eparameter\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Epath\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nx\"\u003Ejson\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Epath\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EOnce we are done with this, the final step is to publish our Apps Script as a Web App. We can simply create a new deployment and set the \u003Cem\u003EExecute As\u003C\u002Fem\u003E to \u003Cstrong\u003Eme\u003C\u002Fstrong\u003E and \u003Cem\u003EWho has access\u003C\u002Fem\u003E to \u003Cstrong\u003EAnyone\u003C\u002Fstrong\u003E. These settings allow our Web App to be publicly accessible.\u003C\u002Fp\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"results\" href=\"#results\"\u003E\n  \u003C\u002Fa\u003E\n  Results\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003ELet us send a GET request to our published Web App using Postman. The path for the GET request would be our Web App’s URL and query parameter \u003Cstrong\u003Epath\u003C\u002Fstrong\u003E set to our Google Sheet’s name.\u003C\u002Fp\u003E\n\n\u003Cp\u003EIn our case, the URL is \u003Ca href=\"https:\u002F\u002Fscript.google.com\u002Fmacros\u002Fs\u002FAKfycbw9gpHbIauF8obidyDjxe3_L9qA-Ww-e8bv6pvNNGavAv-xxxxxxxxxxxxxxxxxxxxxxx\u002Fexec?path=people.\"\u003Ehttps:\u002F\u002Fscript.google.com\u002Fmacros\u002Fs\u002FAKfycbw9gpHbIauF8obidyDjxe3_L9qA-Ww-e8bv6pvNNGavAv-xxxxxxxxxxxxxxxxxxxxxxx\u002Fexec?path=people\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\n\u003Cp\u003E\u003Cfigure\u003E\u003Ca href=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--UHZ7uKlq--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F772\u002F0%2A6jMpSD8zJ3SiC4dg.png\" class=\"article-body-image-wrapper\"\u003E\u003Cimg src=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--UHZ7uKlq--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F772\u002F0%2A6jMpSD8zJ3SiC4dg.png\" alt=\"Google Sheet as a REST API\" loading=\"lazy\"\u003E\u003C\u002Fa\u003E\u003Cfigcaption\u003EGoogle Sheet as a REST API\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003C\u002Fp\u003E\n\n\u003Cp\u003EAlright! We can see that we have transformed our Google Sheet into a REST API in under five minutes using the above code. We can add more sheets in our spreadsheet and access them simply using the sheet name in the path query parameter when sending a GET request.\u003C\u002Fp\u003E\n\n\u003Cp\u003EIf you loved my article, please clap 👏 for it.\u003C\u002Fp\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"connect-with-me\" href=\"#connect-with-me\"\u003E\n  \u003C\u002Fa\u003E\n  Connect with Me\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003EI love writing for the community while working on my freelance and open source projects. Connect with me through \u003Ca href=\"https:\u002F\u002Ftwitter.com\u002Fravgeetdhillon\"\u003ETwitter\u003C\u002Fa\u003E • \u003Ca href=\"https:\u002F\u002Flinkedin.com\u002Fin\u002Fravgeetdhillon\"\u003ELinkedIn\u003C\u002Fa\u003E • \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fravgeetdhillon\"\u003EGithub\u003C\u002Fa\u003E • \u003Ca href=\"\u002F\u002Fmailto:ravgeetdhillon@gmail.com\"\u003EEmail\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"about-ravsam-web-solutions\" href=\"#about-ravsam-web-solutions\"\u003E\n  \u003C\u002Fa\u003E\n  About RavSam Web Solutions\n\u003C\u002Fh4\u003E\n\n\u003Cp\u003EWe are helping companies and startups power their IT infrastructure with modern JAMstack architecture. Reach out to us to know more about our services, pricing, or anything else. We are always looking forward to work on great ideas. If you are looking for \u003Ca href=\"https:\u002F\u002Fwww.ravsam.in\u002F\"\u003Ean application development company\u003C\u002Fa\u003E, you are most welcome to get in touch with us.\u003C\u002Fp\u003E\n\n\u003Ch4\u003E\n  \u003Ca name=\"you-might-also-enjoy-reading\" href=\"#you-might-also-enjoy-reading\"\u003E\n  \u003C\u002Fa\u003E\n  You might also enjoy reading\n\u003C\u002Fh4\u003E\n\n\u003Cul\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fadd-unsubscribe-link-in-emails-using-google-apps-script\u002F\"\u003EAdd Unsubscribe link in emails using Google Apps Script\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fcustom-log-monitoring-service-using-google-apps-script\u002F\"\u003ECustom Log Monitoring using Google Apps Script\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\n\u003Chr\u003E\n\n",body_markdown:"---\ncanonical_url: https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fturning-a-google-sheet-into-a-rest-api\u002F\ndate: 2021-03-24 08:54:13 UTC\npublished: true\ntags: restapi,googleappsscript,webapps\ntitle: Turn a Google Sheet into a REST API\n---\n\n#### Turn your Google Sheet into a REST API and access it in any application.\n\n\u003E This blog was originally published on [RavSam’s blog](https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fturning-a-google-sheet-into-a-rest-api\u002F). We publish our articles on Medium after a week.\n\nWhat if we can use our Google Sheets as a CMS? What if we want the data in our Google Sheet to be publicly available. This can be done easily using Google Sheets and Google Apps Script. In this blog, we will take a look at how we can convert a Google Sheet into a REST API and access it publicly from any app we want.\n\n#### Contents\n\n- 1. Setting up a Spreadsheet\n\n- 2. Creating a Google Apps Script\n\n- 3. Converting data to JSON format\n\n- 4. Creating a Web App\n\n- Results\n\n#### 1. Setting up a Spreadsheet\n\nThe first task is to set up a Spreadsheet and initialize it with some data.\n\n![Format for Google Spreadsheet](https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F1024\u002F0*Na68HQ21zRGTVqbu.png)\u003Cfigcaption\u003EGoogle Spreadsheet with some data\u003C\u002Ffigcaption\u003E\n\n#### 2. Creating a Google Apps Script\n\nThe first step in our journey to convert the above Google Sheet into a REST API is to be able to access the data in it. So, from _Tools_, select _Script Editor_. This will create a new Apps Script project.\n\nLet us start by adding the following snippet of code in the Code.gs file.\n\n```js\nfunction json(sheetName) {\n  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet()\n  const sheet = spreadsheet.getSheetByName(sheetName)\n  const data = sheet.getDataRange().getValues()\n  const jsonData = convertToJson(data)\n  return ContentService\n        .createTextOutput(JSON.stringify(jsonData))\n        .setMimeType(ContentService.MimeType.JSON)\n}\n```\n\nThe above function is really simple to understand. All we are doing is:\n\n- Get the current active spreadsheet to which this Apps Script project is linked with\n\n- Get our specific sheet by its name\n\n- Get the data in that sheet\n\n- Convert the data to JSON format\n\n- Return the JSON response\n\n#### 3. Converting data to JSON format\n\nThe data returned by the sheet.getDataRange().getValues() is of the following format:\n\n```js\n[\n  ['name', 'age', 'role'],\n  ['John', 28.0, 'Front End Engineer'],\n  ['Marry', 21.0, 'Staff Engineer'],\n  ['Jackson', 22.0, 'Backend Engineer']\n]\n```\n\nIn the above snippet, we can see that there is a custom function convertToJson that needs to be written. To convert our sheet data with headers into JSON format, let us the following code in our Apps Script.\n\n```js\nfunction convertToJson(data) {\n  const headers = data[0]\n  const raw_data = data.slice(1,)\n  let json = []\n  raw_data.forEach(d =\u003E {\n      let object = {}\n      for (let i = 0; i \u003C headers.length; i++) {\n        object[headers[i]] = d[i]\n      }\n      json.push(object)\n  });\n  return json\n}\n```\n\n#### 4. Creating a Web App\n\nTo access our Google Sheet as a REST API, we need to publish our Google Apps Script as a Web App. This web app will handle **GET requests**.\n\nLet us add the following code in our Apps Script file:\n\n```js\nfunction doGet(e) {\n  const path = e.parameter.path\n  return json(path)\n}\n```\n\nOnce we are done with this, the final step is to publish our Apps Script as a Web App. We can simply create a new deployment and set the _Execute As_ to **me** and _Who has access_ to **Anyone**. These settings allow our Web App to be publicly accessible.\n\n#### Results\n\nLet us send a GET request to our published Web App using Postman. The path for the GET request would be our Web App’s URL and query parameter **path** set to our Google Sheet’s name.\n\nIn our case, the URL is [https:\u002F\u002Fscript.google.com\u002Fmacros\u002Fs\u002FAKfycbw9gpHbIauF8obidyDjxe3_L9qA-Ww-e8bv6pvNNGavAv-xxxxxxxxxxxxxxxxxxxxxxx\u002Fexec?path=people](https:\u002F\u002Fscript.google.com\u002Fmacros\u002Fs\u002FAKfycbw9gpHbIauF8obidyDjxe3_L9qA-Ww-e8bv6pvNNGavAv-xxxxxxxxxxxxxxxxxxxxxxx\u002Fexec?path=people.)\n\n![Google Sheet as a REST API](https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F772\u002F0*6jMpSD8zJ3SiC4dg.png)\u003Cfigcaption\u003EGoogle Sheet as a REST API\u003C\u002Ffigcaption\u003E\n\nAlright! We can see that we have transformed our Google Sheet into a REST API in under five minutes using the above code. We can add more sheets in our spreadsheet and access them simply using the sheet name in the path query parameter when sending a GET request.\n\nIf you loved my article, please clap 👏 for it.\n\n#### Connect with Me\n\nI love writing for the community while working on my freelance and open source projects. Connect with me through [Twitter](https:\u002F\u002Ftwitter.com\u002Fravgeetdhillon) • [LinkedIn](https:\u002F\u002Flinkedin.com\u002Fin\u002Fravgeetdhillon) • [Github](https:\u002F\u002Fgithub.com\u002Fravgeetdhillon) • [Email](mailto:ravgeetdhillon@gmail.com).\n\n#### About RavSam Web Solutions\n\nWe are helping companies and startups power their IT infrastructure with modern JAMstack architecture. Reach out to us to know more about our services, pricing, or anything else. We are always looking forward to work on great ideas. If you are looking for [an application development company](https:\u002F\u002Fwww.ravsam.in\u002F), you are most welcome to get in touch with us.\n\n#### You might also enjoy reading\n\n- [Add Unsubscribe link in emails using Google Apps Script](https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fadd-unsubscribe-link-in-emails-using-google-apps-script\u002F)\n\n- [Custom Log Monitoring using Google Apps Script](https:\u002F\u002Fwww.ravsam.in\u002Fblog\u002Fcustom-log-monitoring-service-using-google-apps-script\u002F)\n\n* * *",user:{name:"Ravgeet Dhillon",username:b,twitter_username:b,github_username:b,website_url:"https:\u002F\u002Fwww.ravgeet.in",profile_image:"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--CivNIT0S--\u002Fc_fill,f_auto,fl_progressive,h_640,q_auto,w_640\u002Fhttps:\u002F\u002Fdev-to-uploads.s3.amazonaws.com\u002Fuploads\u002Fuser\u002Fprofile_image\u002F373558\u002F6f0be819-1f0e-4d57-ba7c-b2b91e89ae11.jpg",profile_image_90:"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--Fg6K1F1t--\u002Fc_fill,f_auto,fl_progressive,h_90,q_auto,w_90\u002Fhttps:\u002F\u002Fdev-to-uploads.s3.amazonaws.com\u002Fuploads\u002Fuser\u002Fprofile_image\u002F373558\u002F6f0be819-1f0e-4d57-ba7c-b2b91e89ae11.jpg"}}},serverRendered:true,routePath:"\u002Farticles\u002Fravgeetdhillon\u002F640468",config:{_app:{basePath:"\u002F",assetsPath:"\u002F_nuxt\u002F",cdnURL:a}}}}(null,"ravgeetdhillon",15,"2021-03-24T11:57:06Z","2021-03-24T08:54:13Z"));