__NUXT_JSONP__("/articles/swimburger/674150", (function(a,b,c,d,e){a.type_of="article";a.id=674150;a.title="Capture emails during development using smtp4dev and UI Test with Selenium";a.description="If you develop websites for a living, you probably have created a couple of forms that send out...";a.readable_publish_date="May 4";a.slug="capture-emails-during-development-using-smtp4dev-and-ui-test-with-selenium-he2";a.path="\u002Fswimburger\u002Fcapture-emails-during-development-using-smtp4dev-and-ui-test-with-selenium-he2";a.url="https:\u002F\u002Fdev.to\u002Fswimburger\u002Fcapture-emails-during-development-using-smtp4dev-and-ui-test-with-selenium-he2";a.comments_count=0;a.public_reactions_count=b;a.collection_id=c;a.published_timestamp=d;a.positive_reactions_count=b;a.cover_image="https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--XZNpmGNA--\u002Fc_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000\u002Fhttps:\u002F\u002Fswimburger.net\u002Fmedia\u002Fiiih4i1k\u002Fsmtp4dev-selenium-email-capture-social.png%3Fanchor%3Dcenter%26mode%3Dcrop%26width%3D1000%26height%3D420";a.social_image="https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--F99_yG09--\u002Fc_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000\u002Fhttps:\u002F\u002Fswimburger.net\u002Fmedia\u002Fiiih4i1k\u002Fsmtp4dev-selenium-email-capture-social.png%3Fanchor%3Dcenter%26mode%3Dcrop%26width%3D1000%26height%3D420";a.canonical_url="https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fcapture-emails-during-development-using-smtp4dev-and-ui-test-with-selenium";a.created_at="2021-04-21T18:26:22Z";a.edited_at=c;a.crossposted_at=d;a.published_at=e;a.last_comment_at=e;a.reading_time_minutes=7;a.tag_list="dotnet, smtp, aspnet";a.tags=["dotnet","smtp","aspnet"];a.body_html="\u003Cp\u003EIf you develop websites for a living, you probably have created a couple of forms that send out emails. You may have created dozens of them by now and your personal inbox is filled with spam from yourself and your peers testing. So much so that you've created automated Outlook rules to read &amp; archive them automatically.\u003C\u002Fp\u003E\n\n\u003Cp\u003EMaybe it's just me and I'm projecting, but if you find yourself in a similar situation, check out this tool called \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Frnwood\u002Fsmtp4dev\"\u003Esmtp4dev\u003C\u002Fa\u003E. Here's how smtp4dev describes itself on the readme:\u003C\u002Fp\u003E\n\n\u003Cblockquote\u003E\n\u003Cp\u003EA dummy SMTP server for Windows, Linux, Mac OS-X (and maybe elsewhere where .NET Core is available). Lets you test your application without spamming your real customers and without needing to set up a complicated real email server with a special configuration. Messages received in smtp4dev can be viewed and inspected.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\n\u003Cp\u003ESmpt4dev used to be a Windows GUI tool similar to \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FChangemakerStudios\u002FPapercut-SMTP\"\u003EPapercut\u003C\u002Fa\u003E—another excellent dev mail tool—, but now is a \u003Cstrong\u003Ecross-platform service\u003C\u002Fstrong\u003E that you can host locally and remotely. Smtp4dev supports \u003Cstrong\u003ESMTP\u003C\u002Fstrong\u003E , basic \u003Cstrong\u003EIMAP\u003C\u002Fstrong\u003E , and offers a web interface to view the captured emails.\u003Cbr\u003E\u003Cbr\u003E\nYou can also configure relay options so that emails to specific email addresses are relayed to a real SMTP server so that the emails are actually being sent out.\u003C\u002Fp\u003E\n\n\u003Cp\u003ELet's install smtp4dev and try it out.\u003C\u002Fp\u003E\n\u003Ch2\u003E\n  \u003Ca name=\"install-smtp4dev-as-a-net-tool\" href=\"#install-smtp4dev-as-a-net-tool\"\u003E\n  \u003C\u002Fa\u003E\n  Install smtp4dev as a .NET tool\n\u003C\u002Fh2\u003E\n\n\u003Cp\u003ETo install smtp4dev, you need to have the .NET Core SDK 3.1 or up on your machine. When the SDK is installed, run the following command:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight powershell\"\u003E\u003Ccode\u003E\u003Cspan class=\"n\"\u003Edotnet\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Etool\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Einstall\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E-g\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003ERnwood.Smtp4dev\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThis will install smtp4dev as a global .NET tool which will make it available from the command line as \u003Ccode\u003Esmtp4dev\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\n\u003Cp\u003EConsult \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Frnwood\u002Fsmtp4dev\u002Fwiki\u002FInstallation\"\u003Ethe installation instructions\u003C\u002Fa\u003E if you want to run smtp4dev as a docker container, as a Windows service, or run it inside IIS.\u003C\u002Fp\u003E\n\n\u003Cp\u003ENow that smpt4dev is installed, execute the following command to run the tool:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight powershell\"\u003E\u003Ccode\u003E\u003Cspan class=\"n\"\u003Esmtp4dev\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E--urls\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Ehttps:\u002F\u002Flocalhost:5002\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThis command will run smtp4dev locally using the following ports:\u003C\u002Fp\u003E\n\n\u003Cul\u003E\n\u003Cli\u003Eport \u003Cstrong\u003E5002\u003C\u002Fstrong\u003E exposes the \u003Cstrong\u003Ewebserver\u003C\u002Fstrong\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003Eport \u003Cstrong\u003E25\u003C\u002Fstrong\u003E exposes the \u003Cstrong\u003ESMTP\u003C\u002Fstrong\u003E server\u003C\u002Fli\u003E\n\u003Cli\u003Eport \u003Cstrong\u003E143\u003C\u002Fstrong\u003E exposes the \u003Cstrong\u003EIMAP\u003C\u002Fstrong\u003E server\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\u003Cp\u003EIf you omit the \u003Ccode\u003E--urls\u003C\u002Fcode\u003E argument, the webserver will use '\u003Cem\u003E\u003Ca href=\"http:\u002F\u002Flocalhost:5000\"\u003Ehttp:\u002F\u002Flocalhost:5000\u003C\u002Fa\u003E\u003C\u002Fem\u003E' and '\u003Cem\u003E\u003Ca href=\"https:\u002F\u002Flocalhost:5001\"\u003Ehttps:\u002F\u002Flocalhost:5001\u003C\u002Fa\u003E\u003C\u002Fem\u003E'.\u003Cbr\u003E\u003Cbr\u003E\nI recommend specifying a different URL to host smtp4dev to avoid port collision with other ASP.NET Core applications using the same two default hosting URLs.\u003C\u002Fp\u003E\n\n\u003Cp\u003ETo quickly verify the SMTP functionality, open a PowerShell and run this command:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight powershell\"\u003E\u003Ccode\u003E\u003Cspan class=\"n\"\u003ESend-MailMessage\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E-SmtpServer\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nx\"\u003Elocalhost\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E-Subject\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"s2\"\u003E\"Hello World\"\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E-Body\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"s2\"\u003E\"Hello World\"\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E-From\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"s2\"\u003E\"niels@localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"nt\"\u003E-To\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"s2\"\u003E\"niels@localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"w\"\u003E\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThis command will use the smtp4dev SMTP server hosted at \u003Cem\u003Elocalhost:25\u003C\u002Fem\u003E to send an email. When you browse to the smtp4dev dashboard at \u003Cem\u003E\u003Ca href=\"https:\u002F\u002Flocalhost:5002\"\u003Ehttps:\u002F\u002Flocalhost:5002\u003C\u002Fa\u003E\u003C\u002Fem\u003E, you will find the email:\u003C\u002Fp\u003E\n\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--aPMI3buu--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fswimburger.net\u002Fmedia\u002Fxcopryxk\u002Fsmpt4dev-send-mail-message.png\" class=\"article-body-image-wrapper\"\u003E\u003Cimg src=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--aPMI3buu--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fswimburger.net\u002Fmedia\u002Fxcopryxk\u002Fsmpt4dev-send-mail-message.png\" alt=\"Screenshot of the smtp4dev dashboard showing 1 email saying &amp;quot;Hello World&amp;quot;\" loading=\"lazy\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\n\u003Ch2\u003E\n  \u003Ca name=\"send-emails-from-a-form-in-aspnet-core-mvc\" href=\"#send-emails-from-a-form-in-aspnet-core-mvc\"\u003E\n  \u003C\u002Fa\u003E\n  Send emails from a form in ASP.NET Core MVC\n\u003C\u002Fh2\u003E\n\n\u003Cp\u003ESending an email from PowerShell is useful for verifying your SMTP server, but you likely want to send emails from your application.\u003C\u002Fp\u003E\n\n\u003Cp\u003EHere's \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSwimburger\u002FSmtp4devSample\"\u003Ea sample ASP.NET Core MVC application\u003C\u002Fa\u003E that accepts a form submission and sends two emails, one to the submitter of the form and one to the owner of the website.\u003Cbr\u003E\u003Cbr\u003E\nThe emails are sent using the \u003Ccode\u003ESmtpClient\u003C\u002Fcode\u003E which comes with the .NET SDK. This is what the controller looks like for the form:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight csharp\"\u003E\u003Ccode\u003E\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESystem.Diagnostics\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESystem.Net.Mail\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003EMicrosoft.AspNetCore.Mvc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESmpt4devSample.WebApp.Models\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Enamespace\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESmpt4devSample.WebApp.Controllers\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EHomeController\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EController\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EIActionResult\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EIndex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EView\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EHttpPost\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EIActionResult\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EIndex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EContactFormViewModel\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(!\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EModelState\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIsValid\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EView\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EsmtpClient\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ESmtpClient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003EHost\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E\"localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003EPort\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"m\"\u003E25\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n            \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EsubmitterFullName\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E$\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFirstName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ELastName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"c1\"\u003E\u002F\u002F send email to website owner\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EsmtpClient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ESend\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"website@localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E\"niels@localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E$\"Contact Us submission by \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EsubmitterFullName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \n\u003Cspan class=\"s\"\u003E$@\"New Contact Us submission:\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E\n\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E    First Name: \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFirstName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E    Last Name: \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ELastName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E    Email Address: \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EEmailAddress\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E    Question:\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E    \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EQuestion\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"c1\"\u003E\u002F\u002F send email to submitter\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EsmtpClient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ESend\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"niels@localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EcontactFormViewModel\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EEmailAddress\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E\"Thank you for contacting us\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \n                \u003Cspan class=\"s\"\u003E$\"Thank you \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EsubmitterFullName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E for reaching out to us.\\nWe have received your inquiry and will respond to you in 24 hours.\"\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ERedirectToAction\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Enameof\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EThankYou\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EIActionResult\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EThankYou\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EView\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThe controller does the following:\u003C\u002Fp\u003E\n\n\u003Cul\u003E\n\u003Cli\u003EServe the form using the \u003Ccode\u003EIndex()\u003C\u002Fcode\u003E action\u003C\u002Fli\u003E\n\u003Cli\u003EAccept the form submission using the \u003Ccode\u003EIndex(ContactFormViewModel)\u003C\u002Fcode\u003E action. This action does the following\n\n\u003Cul\u003E\n\u003Cli\u003Evalidate form state\u003C\u002Fli\u003E\n\u003Cli\u003Ecreate a SmtpClient that connects to localhost:25\u003C\u002Fli\u003E\n\u003Cli\u003Esend an email to the site owner with all values provided by the form submitter\u003C\u002Fli\u003E\n\u003Cli\u003Esend an email to the email address provided by the form submitter\u003C\u002Fli\u003E\n\u003Cli\u003Eredirect to the \u003Ccode\u003EThankYou()\u003C\u002Fcode\u003E action.\n(Always a good idea to have a dedicated thank you page for optimal analytics tracking 👍)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\u003Cp\u003EThese are the emails you get when submitting the form:\u003C\u002Fp\u003E\n\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--yojvovox--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fswimburger.net\u002Fmedia\u002Fgj0phpl5\u002Fsmpt4dev-aspmvc-submission.png\" class=\"article-body-image-wrapper\"\u003E\u003Cimg src=\"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--yojvovox--\u002Fc_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\u002Fhttps:\u002F\u002Fswimburger.net\u002Fmedia\u002Fgj0phpl5\u002Fsmpt4dev-aspmvc-submission.png\" alt=\"Screenshot of smtp4dev dashboard with 2 additional emails\" loading=\"lazy\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\n\u003Ch2\u003E\n  \u003Ca name=\"ui-test-the-form-using-selenium\" href=\"#ui-test-the-form-using-selenium\"\u003E\n  \u003C\u002Fa\u003E\n  UI Test the form using Selenium\n\u003C\u002Fh2\u003E\n\n\u003Cp\u003EUp until now, the form and email functionality have been verified manually, but if this functionality is important to your website, you should automate this with an end-to-end (E2E) test.\u003Cbr\u003E\u003Cbr\u003E\nHere's how you can test the above form using Selenium and MSTest:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight csharp\"\u003E\u003Ccode\u003E\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESystem\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESystem.Linq\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESystem.Threading.Tasks\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003EMailKit\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003EMailKit.Net.Imap\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003EMicrosoft.VisualStudio.TestTools.UnitTesting\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003EOpenQA.Selenium.Chrome\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Enamespace\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003ESmpt4devSample.UiTests\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETestClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EContactUsFormTests\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EClassInitialize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETask\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ESetupTests\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETestContext\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtestContext\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EchromeDriverInstaller\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EChromeDriverInstaller\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n            \u003Cspan class=\"k\"\u003Eawait\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EchromeDriverInstaller\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EInstall\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETestMethod\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E]\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ETestContactUsForm\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"c1\"\u003E\u002F\u002F output should look like 9014dbca920e40dfa7c760a4a4808759@localhost\u003C\u002Fspan\u003E\n            \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailAddress\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E$\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EGuid\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ENewGuid\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E().\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EToString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"N\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E@localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EchromeOptions\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EChromeOptions\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EchromeOptions\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EAddArguments\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"headless\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n            \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EChromeDriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EchromeOptions\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E))\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ENavigate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E().\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EGoToUrl\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"https:\u002F\u002Flocalhost:5001\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EFindElementById\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"firstName\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E).\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ESendKeys\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Jon\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EFindElementById\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"lastName\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E).\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ESendKeys\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Doe\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n                \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EFindElementById\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"emailAddress\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E).\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ESendKeys\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailAddress\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n                \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EFindElementById\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"question\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E).\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003ESendKeys\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Hello World!\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n                \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EFindElementsByCssSelector\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"form button\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E).\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EFirst\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E().\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EClick\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\n                \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EAreEqual\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"https:\u002F\u002Flocalhost:5001\u002FHome\u002FThankYou\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUrl\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EIsTrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Edriver\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EPageSource\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Thank you for contacting us\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n            \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"c1\"\u003E\u002F\u002F more to come\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThe code does the following:\u003C\u002Fp\u003E\n\n\u003Cul\u003E\n\u003Cli\u003EBefore running the test, the correct ChromeDriver is installed into the bin folder automatically using the ChromeDriverInstaller from a previous blog post: \"\u003Ca href=\"https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fdownload-the-right-chromedriver-version-and-keep-it-up-to-date-on-windows-linux-macos-using-csharp-dotnet\"\u003EDownload the right ChromeDriver version &amp; keep it up to date on Windows\u002FLinux\u002FmacOS using C# .NET\u003C\u002Fa\u003E\"\u003C\u002Fli\u003E\n\u003Cli\u003EThe test itself does the following:\n\n\u003Cul\u003E\n\u003Cli\u003EGenerate a unique email address by using a GUID and concatenating it with \"@localhost\". By using a unique email address for this test session, you avoid false negatives from previous test runs.\u003C\u002Fli\u003E\n\u003Cli\u003ECreate a headless ChromeDriver instance.\nThe ChromeDriver class is provided by the \u003Ccode\u003ESelenium.WebDriver\u003C\u002Fcode\u003E package. You can install the package using this command: \u003Ccode\u003Edotnet add package Selenium.WebDriver\u003C\u002Fcode\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003ENavigate to the form located at \u003Cem\u003E\u003Ca href=\"https:\u002F\u002Flocalhost:5001\"\u003Ehttps:\u002F\u002Flocalhost:5001\u003C\u002Fa\u003E\u003C\u002Fem\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EFill out the form with dummy data\u003C\u002Fli\u003E\n\u003Cli\u003ESubmit the form by clicking the submit button\u003C\u002Fli\u003E\n\u003Cli\u003EVerify you are redirected to the thank you page\u003C\u002Fli\u003E\n\u003Cli\u003EVerify the content of the thank you page\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\u003Cp\u003EThis is a great start, but \u003Cstrong\u003Eunfortunately, this is often where the test automation ends and the manual verification starts\u003C\u002Fstrong\u003E. In many instances, developers and QA engineers will manually verify whether the email was sent out and received, but you can automate this part too.\u003C\u002Fp\u003E\n\n\u003Ch2\u003E\n  \u003Ca name=\"verify-emails-using-imap\" href=\"#verify-emails-using-imap\"\u003E\n  \u003C\u002Fa\u003E\n  Verify emails using IMAP\n\u003C\u002Fh2\u003E\n\n\u003Cp\u003EIf you're not using smtp4dev or you're trying to verify the email functionality in production, you can use different protocols for downloading email like POP or IMAP. Alternatively, if your email service offers an HTTP API like Outlook and Gmail, you can also use that for email verification.\u003C\u002Fp\u003E\n\n\u003Cp\u003ESmtp4dev has IMAP support—tho only basic functionality—which you can use to verify the emails. The test sample continues to verify the email functionality by fetching the emails using IMAP:\u003Cbr\u003E\n\u003C\u002Fp\u003E\n\n\u003Cdiv class=\"highlight js-code-highlight\"\u003E\n\u003Cpre class=\"highlight csharp\"\u003E\u003Ccode\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F more to come\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EImapClient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E())\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EConnect\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"localhost\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"m\"\u003E143\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EAuthenticate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EuserName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Epassword\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F The Inbox folder is always available on all IMAP servers...\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Einbox\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInbox\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Einbox\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EOpen\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFolderAccess\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EReadOnly\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Einbox\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EGetMessage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Einbox\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ECount\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"m\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailToSubmitter\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Einbox\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EGetMessage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Einbox\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ECount\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"m\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EMimeKit\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMimeMessage\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtempMessage\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F swap emails if necessary\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESubject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Contact Us submission by\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E&amp;&amp;\u003C\u002Fspan\u003E \n        \u003Cspan class=\"n\"\u003EemailToSubmitter\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESubject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Contact Us submission by\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"n\"\u003EtempMessage\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailToSubmitter\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"n\"\u003EemailToSubmitter\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EtempMessage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EAreEqual\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Contact Us submission by Jon Doe\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESubject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EIsTrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETextBody\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"First Name: Jon\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EIsTrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETextBody\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Last Name: Doe\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EIsTrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETextBody\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E$\"Email Address: \u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailAddress\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EIsTrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailToSiteOwner\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETextBody\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Hello World!\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EAreEqual\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Thank you for contacting us\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EemailToSubmitter\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESubject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EAssert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EIsTrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EemailToSubmitter\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETextBody\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EContains\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E\"Thank you Jon Doe for reaching out to us.\"\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E));\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"nf\"\u003EDisconnect\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cdiv class=\"highlight__panel js-actions-panel\"\u003E\n\u003Cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003E\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003E\u003Ctitle\u003EEnter fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n    \u003Csvg xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003E\u003Ctitle\u003EExit fullscreen mode\u003C\u002Ftitle\u003E\n    \u003Cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003E\u003C\u002Fpath\u003E\n\u003C\u002Fsvg\u003E\n\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\u003C\u002Fdiv\u003E\n\n\n\n\u003Cp\u003EThe code does the following:\u003C\u002Fp\u003E\n\n\u003Cul\u003E\n\u003Cli\u003ECreate an ImapClient instance. This class is provided by another open-source project called \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjstedfast\u002FMailKit\"\u003EMailkit\u003C\u002Fa\u003E.\nYou can install mailkit into your test project using this command: \u003Ccode\u003Edotnet add package MailKit\u003C\u002Fcode\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EConnect and authenticate to smtp4dev using IMAP\u003C\u002Fli\u003E\n\u003Cli\u003EGet the inbox and open it using read-only mode\u003C\u002Fli\u003E\n\u003Cli\u003EStore the last two messages into \u003Ccode\u003EemailToSiteOwner\u003C\u002Fcode\u003E and \u003Ccode\u003EemailToSubmitter\u003C\u002Fcode\u003E and swap them if necessary\u003C\u002Fli\u003E\n\u003Cli\u003EVerify the contents of the emails match the data from the form submission\u003C\u002Fli\u003E\n\u003Cli\u003Edisconnect and dispose of the ImapClient\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n\u003Cp\u003E\u003Cstrong\u003EIMAP also has support for advanced querying of emails\u003C\u002Fstrong\u003E , but unfortunately, that is not supported by smtp4dev.\u003Cbr\u003E\u003Cbr\u003E\nThe above sample code works fine for local testing, but for a production server where there are many more emails, you should use the \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjstedfast\u002FMailKit#searching-an-imap-folder\"\u003EIMAP querying functionality to find and verify your emails\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\n\u003Ch2\u003E\n  \u003Ca name=\"additional-resources\" href=\"#additional-resources\"\u003E\n  \u003C\u002Fa\u003E\n  Additional resources\n\u003C\u002Fh2\u003E\n\n\u003Cp\u003ECheck out these links to learn more about the topics in this post:\u003C\u002Fp\u003E\n\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Frnwood\u002Fsmtp4dev\"\u003Esmtp4dev GitHub\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fdotnet\u002Fapi\u002Fsystem.net.mail.smtpclient\"\u003ESmtpClient documentation by Microsoft\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSwimburger\u002FSmtp4devSample\"\u003EThe sample code for this post on GitHub\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjstedfast\u002FMailKit#searching-an-imap-folder\"\u003EQuery IMAP sample from MailKit\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fhow-to-ui-test-using-selenium-and-net-core-on-windows-ubuntu-and-maybe-macos\"\u003EHow to UI test using Selenium and .NET Core on Windows, Ubuntu, and MacOS\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fswimburger.net\u002Fblog\u002Fpowershell\u002Fdownload-the-right-chromedriver-on-windows-linux-macos-using-powershell\"\u003EDownload the right ChromeDriver version &amp; keep it up to date on Windows\u002FLinux\u002FmacOS using PowerShell\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fdownload-the-right-chromedriver-version-and-keep-it-up-to-date-on-windows-linux-macos-using-csharp-dotnet\"\u003EDownload the right ChromeDriver version &amp; keep it up to date on Windows\u002FLinux\u002FmacOS using C# .NET\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\n";a.body_markdown="---\ntitle: Capture emails during development using smtp4dev and UI Test with Selenium\npublished: true\ndate: 2021-04-21 00:00:00 UTC\ntags: dotnet,smtp,aspnet\ncanonical_url: https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fcapture-emails-during-development-using-smtp4dev-and-ui-test-with-selenium\ncover_image: https:\u002F\u002Fswimburger.net\u002Fmedia\u002Fiiih4i1k\u002Fsmtp4dev-selenium-email-capture-social.png?anchor=center&mode=crop&width=1000&height=420\n---\n\nIf you develop websites for a living, you probably have created a couple of forms that send out emails. You may have created dozens of them by now and your personal inbox is filled with spam from yourself and your peers testing. So much so that you've created automated Outlook rules to read & archive them automatically.\n\nMaybe it's just me and I'm projecting, but if you find yourself in a similar situation, check out this tool called [smtp4dev](https:\u002F\u002Fgithub.com\u002Frnwood\u002Fsmtp4dev). Here's how smtp4dev describes itself on the readme:\n\n\u003E A dummy SMTP server for Windows, Linux, Mac OS-X (and maybe elsewhere where .NET Core is available). Lets you test your application without spamming your real customers and without needing to set up a complicated real email server with a special configuration. Messages received in smtp4dev can be viewed and inspected.\n\nSmpt4dev used to be a Windows GUI tool similar to [Papercut](https:\u002F\u002Fgithub.com\u002FChangemakerStudios\u002FPapercut-SMTP)—another excellent dev mail tool—, but now is a **cross-platform service** that you can host locally and remotely. Smtp4dev supports **SMTP** , basic **IMAP** , and offers a web interface to view the captured emails.  \nYou can also configure relay options so that emails to specific email addresses are relayed to a real SMTP server so that the emails are actually being sent out.\n\nLet's install smtp4dev and try it out.\n\n## Install smtp4dev as a .NET tool\n\nTo install smtp4dev, you need to have the .NET Core SDK 3.1 or up on your machine. When the SDK is installed, run the following command:\n\n```powershell\ndotnet tool install -g Rnwood.Smtp4dev\n```\n\nThis will install smtp4dev as a global .NET tool which will make it available from the command line as `smtp4dev`.\n\nConsult [the installation instructions](https:\u002F\u002Fgithub.com\u002Frnwood\u002Fsmtp4dev\u002Fwiki\u002FInstallation) if you want to run smtp4dev as a docker container, as a Windows service, or run it inside IIS.\n\nNow that smpt4dev is installed, execute the following command to run the tool:\n\n```powershell\nsmtp4dev --urls=https:\u002F\u002Flocalhost:5002\n```\n\nThis command will run smtp4dev locally using the following ports:\n\n- port **5002** exposes the **webserver**\n- port **25** exposes the **SMTP** server\n- port **143** exposes the **IMAP** server\n\nIf you omit the `--urls` argument, the webserver will use '_http:\u002F\u002Flocalhost:5000_' and '_https:\u002F\u002Flocalhost:5001_'.  \nI recommend specifying a different URL to host smtp4dev to avoid port collision with other ASP.NET Core applications using the same two default hosting URLs.\n\nTo quickly verify the SMTP functionality, open a PowerShell and run this command:\n\n```powershell\nSend-MailMessage -SmtpServer localhost -Subject \"Hello World\" -Body \"Hello World\" -From \"niels@localhost\" -To \"niels@localhost\"\n```\n\nThis command will use the smtp4dev SMTP server hosted at _localhost:25_ to send an email. When you browse to the smtp4dev dashboard at _https:\u002F\u002Flocalhost:5002_, you will find the email:\n\n ![Screenshot of the smtp4dev dashboard showing 1 email saying &quot;Hello World&quot;](https:\u002F\u002Fswimburger.net\u002Fmedia\u002Fxcopryxk\u002Fsmpt4dev-send-mail-message.png)\n\n## Send emails from a form in ASP.NET Core MVC\n\nSending an email from PowerShell is useful for verifying your SMTP server, but you likely want to send emails from your application.\n\nHere's [a sample ASP.NET Core MVC application](https:\u002F\u002Fgithub.com\u002FSwimburger\u002FSmtp4devSample) that accepts a form submission and sends two emails, one to the submitter of the form and one to the owner of the website.   \nThe emails are sent using the `SmtpClient` which comes with the .NET SDK. This is what the controller looks like for the form:\n\n```csharp\nusing System.Diagnostics;\nusing System.Net.Mail;\nusing Microsoft.AspNetCore.Mvc;\nusing Smpt4devSample.WebApp.Models;\n\nnamespace Smpt4devSample.WebApp.Controllers\n{\n    public class HomeController : Controller\n    {\n        public IActionResult Index() =\u003E View();\n\n        [HttpPost]\n        public IActionResult Index(ContactFormViewModel contactFormViewModel)\n        {\n            if(!ModelState.IsValid)\n            {\n                return View();\n            }\n\n            using var smtpClient = new SmtpClient()\n            {\n                Host = \"localhost\",\n                Port = 25\n            };\n            var submitterFullName = $\"{contactFormViewModel.FirstName} {contactFormViewModel.LastName}\";\n            \n            \u002F\u002F send email to website owner\n            smtpClient.Send(\"website@localhost\", \"niels@localhost\", $\"Contact Us submission by {submitterFullName}\", \n$@\"New Contact Us submission:\n\n    First Name: {contactFormViewModel.FirstName}\n    Last Name: {contactFormViewModel.LastName}\n    Email Address: {contactFormViewModel.EmailAddress}\n    Question:\n    {contactFormViewModel.Question}\"\n            );\n\n            \u002F\u002F send email to submitter\n            smtpClient.Send(\"niels@localhost\", contactFormViewModel.EmailAddress, \"Thank you for contacting us\", \n                $\"Thank you {submitterFullName} for reaching out to us.\\nWe have received your inquiry and will respond to you in 24 hours.\"\n            );\n\n            return RedirectToAction(nameof(ThankYou));\n        }\n\n        public IActionResult ThankYou() =\u003E View();\n    }\n}\n\n```\n\nThe controller does the following:\n\n- Serve the form using the `Index()` action\n- Accept the form submission using the `Index(ContactFormViewModel)` action. This action does the following\n  - validate form state\n  - create a SmtpClient that connects to localhost:25\n  - send an email to the site owner with all values provided by the form submitter\n  - send an email to the email address provided by the form submitter\n  - redirect to the `ThankYou()` action.   \n(Always a good idea to have a dedicated thank you page for optimal analytics tracking 👍)\n\nThese are the emails you get when submitting the form:\n\n ![Screenshot of smtp4dev dashboard with 2 additional emails](https:\u002F\u002Fswimburger.net\u002Fmedia\u002Fgj0phpl5\u002Fsmpt4dev-aspmvc-submission.png)\n## UI Test the form using Selenium\n\nUp until now, the form and email functionality have been verified manually, but if this functionality is important to your website, you should automate this with an end-to-end (E2E) test.  \nHere's how you can test the above form using Selenium and MSTest:\n\n```csharp\nusing System;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing MailKit;\nusing MailKit.Net.Imap;\nusing Microsoft.VisualStudio.TestTools.UnitTesting;\nusing OpenQA.Selenium.Chrome;\n\nnamespace Smpt4devSample.UiTests\n{\n    [TestClass]\n    public class ContactUsFormTests\n    {\n        [ClassInitialize]\n        public static async Task SetupTests(TestContext testContext)\n        {\n            var chromeDriverInstaller = new ChromeDriverInstaller();\n            await chromeDriverInstaller.Install();\n        }\n\n        [TestMethod]\n        public void TestContactUsForm()\n        {\n            \u002F\u002F output should look like 9014dbca920e40dfa7c760a4a4808759@localhost\n            var emailAddress = $\"{Guid.NewGuid().ToString(\"N\")}@localhost\";\n\n            var chromeOptions = new ChromeOptions();\n            chromeOptions.AddArguments(\"headless\");\n            using (var driver = new ChromeDriver(chromeOptions))\n            {\n                driver.Navigate().GoToUrl(\"https:\u002F\u002Flocalhost:5001\");\n                driver.FindElementById(\"firstName\").SendKeys(\"Jon\");\n                driver.FindElementById(\"lastName\").SendKeys(\"Doe\");\n\n                driver.FindElementById(\"emailAddress\").SendKeys(emailAddress);\n\n                driver.FindElementById(\"question\").SendKeys(\"Hello World!\");\n\n                driver.FindElementsByCssSelector(\"form button\").First().Click();\n\n                Assert.AreEqual(\"https:\u002F\u002Flocalhost:5001\u002FHome\u002FThankYou\", driver.Url);\n                Assert.IsTrue(driver.PageSource.Contains(\"Thank you for contacting us\"));\n            }\n\n            \u002F\u002F more to come\n        }\n    }\n}\n\n```\n\nThe code does the following:\n\n- Before running the test, the correct ChromeDriver is installed into the bin folder automatically using the ChromeDriverInstaller from a previous blog post: \"[Download the right ChromeDriver version & keep it up to date on Windows\u002FLinux\u002FmacOS using C# .NET](https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fdownload-the-right-chromedriver-version-and-keep-it-up-to-date-on-windows-linux-macos-using-csharp-dotnet \"Download the right ChromeDriver version and keep it up to date on Windows\u002FLinux\u002FmacOS using csharp dotNET\")\"\n- The test itself does the following:\n  - Generate a unique email address by using a GUID and concatenating it with \"@localhost\". By using a unique email address for this test session, you avoid false negatives from previous test runs.\n  - Create a headless ChromeDriver instance.   \nThe ChromeDriver class is provided by the `Selenium.WebDriver` package. You can install the package using this command: `dotnet add package Selenium.WebDriver`\n  - Navigate to the form located at _https:\u002F\u002Flocalhost:5001_\n  - Fill out the form with dummy data\n  - Submit the form by clicking the submit button\n  - Verify you are redirected to the thank you page\n  - Verify the content of the thank you page\n\nThis is a great start, but **unfortunately, this is often where the test automation ends and the manual verification starts**. In many instances, developers and QA engineers will manually verify whether the email was sent out and received, but you can automate this part too.\n\n## Verify emails using IMAP\n\nIf you're not using smtp4dev or you're trying to verify the email functionality in production, you can use different protocols for downloading email like POP or IMAP. Alternatively, if your email service offers an HTTP API like Outlook and Gmail, you can also use that for email verification.\n\nSmtp4dev has IMAP support—tho only basic functionality—which you can use to verify the emails. The test sample continues to verify the email functionality by fetching the emails using IMAP:\n\n```csharp\n\u002F\u002F more to come\n\nusing (var client = new ImapClient())\n{\n    client.Connect(\"localhost\", 143);\n    client.Authenticate(userName: \"\", password: \"\");\n\n    \u002F\u002F The Inbox folder is always available on all IMAP servers...\n    var inbox = client.Inbox;\n    inbox.Open(FolderAccess.ReadOnly);\n\n    var emailToSiteOwner = inbox.GetMessage(inbox.Count - 1);\n    var emailToSubmitter = inbox.GetMessage(inbox.Count - 2);\n    MimeKit.MimeMessage tempMessage = null;\n\n    \u002F\u002F swap emails if necessary\n    if(\n        !emailToSiteOwner.Subject.Contains(\"Contact Us submission by\") && \n        emailToSubmitter.Subject.Contains(\"Contact Us submission by\")\n    )\n    {\n        tempMessage = emailToSiteOwner;\n        emailToSiteOwner = emailToSubmitter;\n        emailToSubmitter = tempMessage;\n    }\n\n    Assert.AreEqual(\"Contact Us submission by Jon Doe\", emailToSiteOwner.Subject);\n    Assert.IsTrue(emailToSiteOwner.TextBody.Contains(\"First Name: Jon\"));\n    Assert.IsTrue(emailToSiteOwner.TextBody.Contains(\"Last Name: Doe\"));\n    Assert.IsTrue(emailToSiteOwner.TextBody.Contains($\"Email Address: {emailAddress}\"));\n    Assert.IsTrue(emailToSiteOwner.TextBody.Contains(\"Hello World!\"));\n\n    Assert.AreEqual(\"Thank you for contacting us\", emailToSubmitter.Subject);\n    Assert.IsTrue(emailToSubmitter.TextBody.Contains(\"Thank you Jon Doe for reaching out to us.\"));\n\n    client.Disconnect(true);\n}\n\n```\n\nThe code does the following:\n\n- Create an ImapClient instance. This class is provided by another open-source project called [Mailkit](https:\u002F\u002Fgithub.com\u002Fjstedfast\u002FMailKit).  \nYou can install mailkit into your test project using this command: `dotnet add package MailKit`\n- Connect and authenticate to smtp4dev using IMAP\n- Get the inbox and open it using read-only mode\n- Store the last two messages into `emailToSiteOwner` and `emailToSubmitter` and swap them if necessary\n- Verify the contents of the emails match the data from the form submission\n- disconnect and dispose of the ImapClient\n\n**IMAP also has support for advanced querying of emails** , but unfortunately, that is not supported by smtp4dev.   \nThe above sample code works fine for local testing, but for a production server where there are many more emails, you should use the [IMAP querying functionality to find and verify your emails](https:\u002F\u002Fgithub.com\u002Fjstedfast\u002FMailKit#searching-an-imap-folder).\n\n## Additional resources\n\nCheck out these links to learn more about the topics in this post:\n\n- [smtp4dev GitHub](https:\u002F\u002Fgithub.com\u002Frnwood\u002Fsmtp4dev)\n- [SmtpClient documentation by Microsoft](https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fdotnet\u002Fapi\u002Fsystem.net.mail.smtpclient)\n- [The sample code for this post on GitHub](https:\u002F\u002Fgithub.com\u002FSwimburger\u002FSmtp4devSample)\n- [Query IMAP sample from MailKit](https:\u002F\u002Fgithub.com\u002Fjstedfast\u002FMailKit#searching-an-imap-folder)\n- [How to UI test using Selenium and .NET Core on Windows, Ubuntu, and MacOS](https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fhow-to-ui-test-using-selenium-and-net-core-on-windows-ubuntu-and-maybe-macos \"How to UI test using Selenium and .NET Core on Windows, Ubuntu, and maybe MacOS?\")\n- [Download the right ChromeDriver version & keep it up to date on Windows\u002FLinux\u002FmacOS using PowerShell](https:\u002F\u002Fswimburger.net\u002Fblog\u002Fpowershell\u002Fdownload-the-right-chromedriver-on-windows-linux-macos-using-powershell \"Download the right ChromeDriver on Windows Linux macOS using PowerShell\")\n- [Download the right ChromeDriver version & keep it up to date on Windows\u002FLinux\u002FmacOS using C# .NET](https:\u002F\u002Fswimburger.net\u002Fblog\u002Fdotnet\u002Fdownload-the-right-chromedriver-version-and-keep-it-up-to-date-on-windows-linux-macos-using-csharp-dotnet \"Download the right ChromeDriver version and keep it up to date on Windows\u002FLinux\u002FmacOS using csharp dotNET\")";a.user={name:"Niels Swimberghe",username:"swimburger",twitter_username:"RealSwimburger",github_username:"Swimburger",website_url:"https:\u002F\u002Fswimburger.net",profile_image:"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--7E8-p0HN--\u002Fc_fill,f_auto,fl_progressive,h_640,q_auto,w_640\u002Fhttps:\u002F\u002Fdev-to-uploads.s3.amazonaws.com\u002Fuploads\u002Fuser\u002Fprofile_image\u002F127864\u002F2e1e9ab3-db6e-47ee-a41a-72320f7e58c0.jpg",profile_image_90:"https:\u002F\u002Fres.cloudinary.com\u002Fpracticaldev\u002Fimage\u002Ffetch\u002Fs--rtzvwXvf--\u002Fc_fill,f_auto,fl_progressive,h_90,q_auto,w_90\u002Fhttps:\u002F\u002Fdev-to-uploads.s3.amazonaws.com\u002Fuploads\u002Fuser\u002Fprofile_image\u002F127864\u002F2e1e9ab3-db6e-47ee-a41a-72320f7e58c0.jpg"};return {data:[{}],fetch:{"data-v-25febe66:0":{article:a}},mutations:[["SET_CURRENT_ARTICLE",a]]}}({},1,null,"2021-05-04T15:23:47Z","2021-04-21T00:00:00Z")));